æ¯”èµ›é¢˜ç›®ï¼šHull Tactical - Market Prediction
Can you predict market predictability?


Hull Tactical - Market Prediction

Submit Prediction
Overview
Your task is to predict the stock market returns as represented by the excess returns of the S&P 500 while also managing volatility constraints. Your work will test the Efficient Market Hypothesis and challenge common tenets of personal finance.

Start

6 days ago
Close
3 months to go
Merger & Entry
Description
Wisdom from most personal finance experts would suggest that it's irresponsible to try and time the market. The Efficient Market Hypothesis (EMH) would agree: everything knowable is already priced in, so donâ€™t bother trying.

But in the age of machine learning, is it irresponsible to not try and time the market? Is the EMH an extreme oversimplification at best and possibly justâ€¦false?

This competition is about more than predictive modeling. Predicting market returns challenges the assumptions of market efficiency. Your work could help reshape how investors and academics understand financial markets. Participants could uncover signals others overlook, develop innovative strategies, and contribute to a deeper understanding of market behaviorâ€”potentially rewriting a fundamental principle of modern finance. Most investors donâ€™t beat the S&P 500. That failure has been used for decades to prop up EMH: If even the professionals canâ€™t win, it must be impossible. This observation has long been cited as evidence for the Efficient Market Hypothesis the idea that prices already reflect all available information and no persistent edge is possible. This story is tidy, but reality is less so. Markets are noisy, messy, and full of behavioral quirks that donâ€™t vanish just because academic orthodoxy said they should.

Data science has changed the game. With enough features, machine learning, and creativity, itâ€™s possible to uncover repeatable edges that theory says shouldnâ€™t exist. The real challenge isnâ€™t whether they existâ€”itâ€™s whether you can find them and combine them in a way that is robust enough to overcome frictions and implementation issues.

Our current approach blends a handful of quantitative models to adjust market exposure at the close of each trading day. It points in the right direction, but with a blurry compass. Our model is clearly a sub-optimal way to model a complex, non-linear, adaptive system. This competition asks you to do better: to build a model that predicts excess returns and includes a betting strategy designed to outperform the S&P 500 while staying within a 120% volatility constraint. Weâ€™ll provide daily data that combines public market information with our proprietary dataset, giving you the raw material to uncover patterns most miss.

Unlike many Kaggle challenges, this isnâ€™t just a theoretical exercise. The models you build here could be valuable in live investment strategies. And if you succeed, youâ€™ll be doing more than improving a prediction engineâ€”youâ€™ll be helping to demonstrate that financial markets are not fully efficient, challenging one of the cornerstones of modern finance, and paving the way for better, more accessible tools for investors.

Evaluation
The competition's metric is a variant of the Sharpe ratio that penalizes strategies that take on significantly more volatility than the underlying market or fail to outperform the market's return. The metric code is available here.

Submission File
You must submit to this competition using the provided evaluation API, which ensures that models do not peek forward in time. For each trading day, you must predict an optimal allocation of funds to holding the S&P500. As some leverage is allowed, the valid range covers 0 to 2. See this example notebook for more details.

Timeline
This is a forecasting competition with an active training phase and a separate forecasting phase where models will be run against real market returns.
Training Timeline:
September 16, 2025 - Start Date.
December 8, 2025 - Entry Deadline. You must accept the competition rules before this date in order to compete.
December 8, 2025 - Team Merger Deadline. This is the last day participants may join or merge teams.
December 15, 2025 - Final Submission Deadline.
All deadlines are at 11:59 PM UTC on the corresponding day unless otherwise noted. The competition organizers reserve the right to update the contest timeline if they deem it necessary.

Forecasting Timeline:
Starting after the final submission deadline there will be periodic updates to the leaderboard to reflect market data updates that will be run against selected notebooks.

June 16, 2026 - Competition End Date
Prizes
1st Place - $50,000
2nd Place - $25,000
3rd Place - $10,000
4th Place - $5,000
5th Place - $5,000
6th Place - $5,000
Code Requirements


Submissions to this competition must be made through Notebooks. In order for the "Submit" button to be active after a commit, the following conditions must be met:

CPU Notebook <= 8 hours run-time
GPU Notebook <= 8 hours run-time
Internet access disabled
Freely & publicly available external data is allowed, including pre-trained models
Forecasting Phase
The run-time limits for both CPU and GPU notebooks will be extended to 9 hours during the forecasting phase. You must ensure your submission completes within that time.

The extra hour is to help protect against time-out failures due to the extended size of the test set. You are still responsible for ensuring your submission completes within the 9 hour limit, however. See the Data page for details on the extended test set during the forecasting phase.

Please see the Code Competition FAQ for more information on how to submit. And review the code debugging doc if you are encountering submission errors.

Citation
Blair Hull, Petra Bakosova, Laurent Lanteigne, Aishvi Shah, Euan C Sinclair, Petri Fast, Will Raj, Harold Janecek, Sohier Dane, and Addison Howard. Hull Tactical - Market Prediction. https://kaggle.com/competitions/hull-tactical-market-prediction, 2025. Kaggle.


æ•°æ®æè¿°ï¼šDataset Description
This competition challenges you to predict the daily returns of the S&P 500 index using a tailored set of market data features.

Competition Phases and Data Updates
The competition will proceed in two phases:

A model training phase with a test set of six months of historical data. Because these prices are publicly available leaderboard scores during this phase are not meaningful.
A forecasting phase with a test set to be collected after submissions close. You should expect the scored portion of the test set to be about the same size as the scored portion of the test set in the first phase.
During the forecasting phase the evaluation API will serve test data from the beginning of the public set to the end of the private set. This includes trading days before the submission deadline, which will not be scored. The first date_id served by the API will remain constant throughout the competition.

Files
train.csv Historic market data. The coverage stretches back decades; expect to see extensive missing values early on.

date_id - An identifier for a single trading day.
M* - Market Dynamics/Technical features.
E* - Macro Economic features.
I* - Interest Rate features.
P* - Price/Valuation features.
V* - Volatility features.
S* - Sentiment features.
MOM* - Momentum features.
D* - Dummy/Binary features.
forward_returns - The returns from buying the S&P 500 and selling it a day later. Train set only.
risk_free_rate - The federal funds rate. Train set only.
market_forward_excess_returns - Forward returns relative to expectations. Computed by subtracting the rolling five-year mean forward returns and winsorizing the result using a median absolute deviation (MAD) with a criterion of 4. Train set only.
test.csv A mock test set representing the structure of the unseen test set. The test set used for the public leaderboard set is a copy of the last 180 date IDs in the train set. As a result, the public leaderboard scores are not meaningful. The unseen copy of this file served by the evaluation API may be updated during the model training phase.

date_id
[feature_name] - The feature columns are the same as in train.csv.
is_scored - Whether this row is included in the evaluation metric calculation. During the model training phase this will be true for the first 180 rows only. Test set only.
lagged_forward_returns - The returns from buying the S&P 500 and selling it a day later, provided with a lag of one day.
lagged_risk_free_rate - The federal funds rate, provided with a lag of one day.
lagged_market_forward_excess_returns - Forward returns relative to expectations. Computed by subtracting the rolling five-year mean forward returns and winsorizing the result using a median absolute deviation (MAD) with a criterion of 4, provided with a lag of one day.
kaggle_evaluation/ Files used by the evaluation API. See the demo submission for an illustration of how to use the API.

Once the competition ends, we will periodically publish our data on our website, and you're welcome to use it for your own trading

éƒ¨åˆ†æ•°æ® train.csv:

date_id,D1,D2,D3,D4,D5,D6,D7,D8,D9,E1,E10,E11,E12,E13,E14,E15,E16,E17,E18,E19,E2,E20,E3,E4,E5,E6,E7,E8,E9,I1,I2,I3,I4,I5,I6,I7,I8,I9,M1,M10,M11,M12,M13,M14,M15,M16,M17,M18,M2,M3,M4,M5,M6,M7,M8,M9,P1,P10,P11,P12,P13,P2,P3,P4,P5,P6,P7,P8,P9,S1,S10,S11,S12,S2,S3,S4,S5,S6,S7,S8,S9,V1,V10,V11,V12,V13,V2,V3,V4,V5,V6,V7,V8,V9,forward_returns,risk_free_rate,market_forward_excess_returns
0,0,0,0,1,1,0,0,0,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.0024211742695206,0.000300793650793651,-0.00303847935997865
1,0,0,0,1,1,0,0,0,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.00849467703679185,0.000302777777777778,-0.00911404561931339
2,0,0,0,1,0,0,0,0,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.00962447844228109,0.000301190476190476,-0.0102425375009931
3,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.004662397483429,0.000299206349206349,0.00404620350408207
4,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.0116857701984905,0.000299206349206349,-0.0123006546540279
5,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.00644942294636774,0.000299603174603175,-0.00706593438603214
6,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.00364423186425245,0.000297619047619048,0.0030294267737944
7,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.0245659820719392,0.000299603174603175,-0.025182810971921
8,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.00849182806956328,0.000297619047619048,-0.00910544268383085
9,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0112629788232534,0.000297619047619048,0.0106493642089859
10,0,0,0,1,0,0,0,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-0.00968733685248569,0.000302777777777778,-0.0103067451175469

###AIæ”¶åˆ°è¿™ä»½æ–‡ä»¶åè¯·ä»”ç»†é˜…Rè¯»æ¯ä¸€è¡Œä»£ç å’Œæ–‡å­—æè¿°ï¼Œç»“æŸåå‘Šè¯‰æˆ‘ä½ æœ‰å“ªäº›ä¸æ‡‚å¾—ï¼Œå’±ä»¬ç»§ç»­ç ”ç©¶ï¼

Hull Tactical - Market Prediction | é¡¹ç›®æ—¥å¿— (Project Log)
æœ¬æ–‡æ¡£è®°å½•äº†æˆ‘ä»¬åœ¨â€œHull Tactical - å¸‚åœºé¢„æµ‹â€æŒ‘æˆ˜èµ›ä¸­çš„å®Œæ•´æ¢ç´¢å†ç¨‹ã€æ–¹æ³•è®ºæ¼”è¿›å’Œæ ¸å¿ƒå‘ç°ã€‚
ç¬¬ä¸€ç« ï¼šæ ¸å¿ƒå“²å­¦ä¸æˆ˜ç•¥è§„åˆ’ (Core Philosophy & Strategy)
1.1 ä½œæˆ˜æ¡ä»¤ (Project Doctrine)
æœ¬é¡¹ç›®çš„å››ä¸ªæ ¸å¿ƒæŒ‡å¯¼åŸåˆ™ï¼Œæ„æˆäº†æ‰€æœ‰å†³ç­–çš„åŸºçŸ³ï¼š
éªŒè¯ä¸ºç‹ (Validation is King): ä¸¥æ ¼çš„æ—¶é—´åºåˆ—äº¤å‰éªŒè¯æ˜¯æˆ‘ä»¬å”¯ä¸€çš„çœŸç†æ ‡å‡†ï¼Œå…¬å¼€æ’è¡Œæ¦œè¢«è§†ä¸ºå™ªéŸ³ã€‚
ä¾¦å¯Ÿå…ˆè¡Œ (Reconnaissance First): é€šè¿‡æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰å»ºç«‹å¯¹æ•°æ®çš„ç›´è§‰ï¼Œæ˜¯æ‰€æœ‰å»ºæ¨¡å·¥ä½œçš„å‰æã€‚
ç‰¹å¾ä¸ºé­‚ (Features are the Soul): å·¥ä½œçš„æ ¸å¿ƒæ˜¯åˆ›é€ å¹¶ç­›é€‰é«˜è´¨é‡çš„ç‰¹å¾ï¼Œå…¶ä»·å€¼è¿œè¶…å¤æ‚çš„æ¨¡å‹ã€‚
å¸ˆå¤·é•¿æŠ€ï¼Œå¿—åœ¨è¶…è¶Š (Learn from Champions, Aim to Surpass): æˆ‘ä»¬çš„æˆ˜ç•¥å§‹äºå¯¹å† å†›æ–¹æ¡ˆçš„æ·±åº¦å­¦ä¹ ï¼Œä½†æœ€ç»ˆç›®æ ‡æ˜¯ç”¨æ›´å…ˆè¿›çš„æŠ€æœ¯å’Œæ›´æ·±åˆ»çš„ç†è§£å»è¶…è¶Šå®ƒã€‚
1.2 æˆ˜åœºç¯å¢ƒåˆ†æ (Data Deep Dive)
æ ¸å¿ƒæˆ˜åœº: ä¸€ä¸ªå…¸å‹çš„ã€å……æ»¡å™ªéŸ³çš„åŒ¿ååŒ–é‡‘èæ—¶é—´åºåˆ—æ•°æ®é›† (train.csv)ã€‚
å…³é”®å‘ç°: æ•°æ®å­˜åœ¨æ˜æ˜¾çš„â€œå¤šæ—¶ä»£â€ç»“æ„æ€§æ–­è£‚ï¼Œæ—©æœŸæ•°æ®ï¼ˆå¦‚date_id < 1055ï¼‰åŒ…å«å¤§é‡å™ªéŸ³ï¼Œå¿…é¡»è¢«å®¡æ…å¤„ç†æˆ–æ’é™¤ã€‚
æˆ˜ç•¥å†³ç­–: æˆ‘ä»¬å°†é‡ç‚¹æ”¾åœ¨â€œç°ä»£å²â€æ•°æ®ä¸Šï¼Œå¹¶é€šè¿‡æ•°æ®è´¨é‡é—¨ç¦ï¼ˆå¦‚å‰”é™¤é«˜ç¼ºå¤±ç‡ç‰¹å¾ï¼‰æ¥å¹³è¡¡æ•°æ®çš„æ•°é‡ä¸è´¨é‡ã€‚
1.3 æ€»ä½“ä½œæˆ˜è®¡åˆ’ (High-Level Battle Plan)
æˆ‘ä»¬åˆ¶å®šäº†ä¸‰é˜¶æ®µè¿›åŒ–æ–¹é’ˆï¼š
ç¬¬ä¸€é˜¶æ®µ - åŸºåœ°å»ºè®¾: å»ºç«‹ä¸€ä¸ªå¼ºå¤§ã€å¯é ã€åŒ…å«åŸºå‡†åˆ†æ•°çš„LightGBMå»ºæ¨¡æµæ°´çº¿ã€‚
ç¬¬äºŒé˜¶æ®µ - å†›å¤‡ç«èµ›: ç³»ç»Ÿæ€§åœ°ã€å¤§è§„æ¨¡åœ°åˆ›é€ ã€éªŒè¯å¹¶ç­›é€‰æ‰‹å·¥ç‰¹å¾å’ŒAIç‰¹å¾ï¼Œæ„å»ºâ€œç‰¹å¾æŠ¤åŸæ²³â€ã€‚
ç¬¬ä¸‰é˜¶æ®µ - ç»ˆå±€ä¹‹æˆ˜: å°†æ‰€æœ‰ä¼˜åŠ¿å…µåŠ›ï¼ˆæ‰‹å·¥ç‰¹å¾ã€AIç‰¹å¾ã€å…ˆè¿›æ¨¡å‹ï¼‰è¿›è¡Œæœ€ä¼˜åŒ–ç»„åˆï¼Œå¹¶é€šè¿‡æ¨¡å‹èåˆå‘èµ·æ€»æ”»ã€‚
ç¬¬äºŒç« ï¼šæ–¹æ³•è®ºçš„æ¼”è¿›ä¸å…³é”®çªç ´ (Methodology Evolution & Breakthroughs)
æˆ‘ä»¬çš„æ¢ç´¢è¿‡ç¨‹å¹¶éä¸€å¸†é£é¡ºï¼Œè€Œæ˜¯ç»å†äº†ä¸€ç³»åˆ—å…³é”®çš„è®¤çŸ¥å‡çº§ï¼Œæœ€ç»ˆå½¢æˆäº†ä¸€å¥—ä¸“ä¸šã€ç¨³å¥çš„æœºå™¨å­¦ä¹ æµæ°´çº¿ã€‚
é˜¶æ®µä¸€ï¼šä»å™ªéŸ³é©±åŠ¨åˆ°ä¿¡å·é©±åŠ¨ (åŸºçº¿å»ºç«‹)
åˆæ­¥è¯•æ¢: ç›´æ¥åœ¨å®Œæ•´æ•°æ®ä¸Šè®­ç»ƒLGBMï¼Œæ¨¡å‹è¡¨ç°æå·®ï¼Œå› å™ªéŸ³å¹²æ‰°è€Œæ— æ³•å­¦ä¹ ã€‚
æ—¶é—´åºåˆ—è®¤çŸ¥ (é‡å¤§å‘ç° #1): å¯¹æ¯”å¤šç§å¡«å……ç­–ç•¥ï¼Œå‘ç°å°Šé‡æ—¶åºå…³ç³»ï¼ˆå¦‚ffillï¼‰èƒ½å¸¦æ¥æ›´å¥½ç»“æœï¼Œè¯æ˜äº†æ•°æ®çš„å¼ºæ—¶é—´åºåˆ—ç‰¹æ€§ã€‚
å†³å®šæ€§çªç ´ (é‡å¤§å‘ç° #2): é€šè¿‡â€œæ•°æ®å¯ç”¨æ€§ç­›é€‰â€ï¼ˆä»…ä½¿ç”¨date_id > 1055çš„æ•°æ®ï¼‰ï¼Œæ¨¡å‹æ€§èƒ½å‘ç”Ÿè´¨çš„é£è·ƒã€‚**æ¶ˆé™¤æ—©æœŸâ€œåƒåœ¾æ•°æ®â€**æ˜¯å°†æ¨¡å‹ä»â€œå™ªéŸ³é©±åŠ¨â€è½¬å˜ä¸ºâ€œä¿¡å·é©±åŠ¨â€çš„å…³é”®ä¸€æ­¥ã€‚
é˜¶æ®µäºŒï¼šä»æ‰‹å·¥è°ƒå‚åˆ°è‡ªåŠ¨é©å‘½ (æ¨¡å‹ä¼˜åŒ–)
é­é‡ç“¶é¢ˆ: å³ä½¿å¼•å…¥äº†å¤§é‡æ‰‹å·¥ç‰¹å¾ï¼Œæ¨¡å‹ä¾ç„¶å› å‚æ•°ä¸å½“è€Œä¸¥é‡æ¬ æ‹Ÿåˆã€‚
æ¨¡å‹å”¤é†’ (é‡å¤§å‘ç° #3): é€šè¿‡æ‰‹åŠ¨è°ƒæ•´n_estimatorså’Œlearning_rateç­‰æ ¸å¿ƒå‚æ•°ï¼Œæ¨¡å‹è¢«æˆåŠŸâ€œå”¤é†’â€ï¼Œè¯æ˜äº†ç‰¹å¾é›†çš„æœ‰æ•ˆæ€§ï¼Œç“¶é¢ˆåœ¨äºè®­ç»ƒç­–ç•¥ã€‚
AIæŒ‡æŒ¥å®˜ç™»åœº (é‡å¤§å‘ç° #4): å¼•å…¥è‡ªåŠ¨åŒ–è°ƒå‚åº“Optunaï¼Œä½¿å…¶è‡ªåŠ¨æœç´¢è¶…å‚æ•°ï¼ŒæˆåŠŸæ‰¾åˆ°äº†ç¬¬ä¸€å¥—â€œé»„é‡‘å‚æ•°ç»„åˆâ€ï¼Œå¹¶åˆ·æ–°äº†æ€§èƒ½è®°å½•ã€‚
â€œå°‘å³æ˜¯å¤šâ€åŸåˆ™ (é‡å¤§å‘ç° #5): é€šè¿‡å¯¹ä¸åŒè§„æ¨¡ç‰¹å¾é›†çš„æ¨ªå‘è¯„æµ‹ï¼Œè¯æ˜äº†ä¸€ä¸ªç”±Top 30ç²¾è‹±ç‰¹å¾ç»„æˆçš„â€œç‰¹ç§éƒ¨é˜Ÿâ€ï¼Œå…¶è¡¨ç°ä¼˜äºæ›´å¤§è§„æ¨¡çš„éƒ¨é˜Ÿã€‚
é˜¶æ®µä¸‰ï¼šä»ç›®æ ‡æ³„éœ²åˆ°å› æœéªŒè¯ (éªŒè¯æ¡†æ¶çš„é©å‘½)
å‘ç°è‡´å‘½BUG: è¯†åˆ«å¹¶ä¿®å¤äº†å¤šä¸ªæ·±å±‚æ¬¡çš„æ•°æ®æ³„éœ²é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š
ç‰¹å¾æ±¡æŸ“: å°†å¸¦æœ‰æœªæ¥ä¿¡æ¯çš„market_forward_excess_returnsç­‰åˆ—é”™è¯¯åœ°ç”¨ä½œç‰¹å¾ã€‚
â€œæ—¶é—´æ—…è¡Œâ€æ¼æ´: ä½¿ç”¨äº†KFold(shuffle=True)ï¼Œç ´åäº†é‡‘èæ•°æ®ä¸¥æ ¼çš„æ—¶é—´å› æœé“¾ã€‚
é”»é€ ç»ˆææ­¦å™¨: å…¨é¢é‡‡ç”¨Purged and Embargoed TimeSeriesSplitå–ä»£äº†æ‰€æœ‰è„šæœ¬ä¸­çš„KFoldï¼Œæ„å»ºäº†ä¸€å¥—å…¨æ–°çš„ã€ä¸šç•Œé¢†å…ˆçš„ã€ä¸¥æ ¼éµå®ˆå› æœå¾‹çš„éªŒè¯æ¡†æ¶ã€‚
æ­£æœ¬æ¸…æº: å°†è¿™å¥—ç»ˆæéªŒè¯æ–¹æ³•ï¼Œè‡ªä¸Šè€Œä¸‹åœ°åº”ç”¨åˆ°äº†æµæ°´çº¿çš„æ¯ä¸€ä¸ªæ ¸å¿ƒç¯èŠ‚ï¼ˆAIç‰¹å¾ç”Ÿæˆã€ç‰¹å¾ç­›é€‰ã€è‡ªåŠ¨è°ƒå‚ï¼‰ï¼Œç¡®ä¿äº†æ‰€æœ‰è¯„ä¼°ç»“æœçš„â€œè¯šå®æ€§â€ã€‚
é˜¶æ®µå››ï¼šä»åˆ†ç¦»è„šæœ¬åˆ°ç»Ÿä¸€æŒ‡æŒ¥ (æ¶æ„çš„ç°ä»£åŒ–)
ç—…ç—‡è¯Šæ–­: è®¤è¯†åˆ°åˆ†ç¦»çš„å¤šä¸ªè„šæœ¬å­˜åœ¨åŠŸèƒ½é‡å ã€æµç¨‹å‰²è£‚å’Œé…ç½®ä¸ç»Ÿä¸€çš„ä¸¥é‡é—®é¢˜ï¼Œè¿™ä¸ä»…å¯¼è‡´äº†éšè”½çš„**â€œæ–¹æ³•è®ºæ•°æ®æ³„éœ²â€**ï¼Œä¹Ÿæå¤§åœ°é™ä½äº†å®éªŒæ•ˆç‡ã€‚
æ¶æ„é‡æ„ (æ ¸å¿ƒçªç ´): æˆ‘ä»¬å°†æ‰€æœ‰æ ¸å¿ƒèƒ½åŠ›ï¼Œå…¨éƒ¨æ•´åˆåˆ°äº†ä¸€ä¸ªç”±å‘½ä»¤è¡Œé©±åŠ¨çš„**main.pyè‡ªåŠ¨åŒ–æŒ‡æŒ¥ä¸­å¿ƒ**ã€‚è¯¥å¹³å°ç”±config.pyï¼ˆå”¯ä¸€çš„é…ç½®æºï¼‰å’Œutils.pyï¼ˆå¯å¤ç”¨çš„å·¥å…·ç®±ï¼‰æä¾›æ”¯æŒï¼Œå®ç°äº†å·¥ä½œæµçš„æ ‡å‡†åŒ–å’Œè‡ªåŠ¨åŒ–ã€‚
å»ºç«‹â€œè¯šå®åŸºå‡†â€: åœ¨å…¨æ–°çš„é›†æˆåŒ–æ¡†æ¶ä¸‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç¬¬ä¸€ä¸ªç»å¯¹å¯é çš„åŸºå‡†AUC: 0.5088ã€‚è¿™ä¸ªåˆ†æ•°è™½ç„¶ä½ï¼Œä½†å®ƒæ­ç¤ºäº†è¿‡å»å› æ–¹æ³•è®ºæ³„éœ²äº§ç”Ÿçš„å·¨å¤§â€œåˆ†æ•°æ³¡æ²«â€ï¼Œæ˜¯æˆ‘ä»¬ç§‘å­¦ä¼˜åŒ–çš„åšå®èµ·ç‚¹ã€‚
å¯é‡åŒ–çš„èƒœåˆ©: é€šè¿‡åœ¨æ–°æ¡†æ¶ä¸‹æ‰§è¡Œ**â€œåˆ†æ­¥ä¼˜åŒ–â€**ç­–ç•¥ï¼ˆå…ˆè°ƒLGBMï¼Œå†è°ƒAEï¼‰ï¼Œæˆ‘ä»¬åœ¨â€œè¯šå®åŸºå‡†â€ä¹‹ä¸Šï¼Œå–å¾—äº†ç¬¬ä¸€æ¬¡å¯é‡åŒ–çš„ã€çœŸå®çš„æ€§èƒ½é£è·ƒã€‚
ç¬¬ä¸‰ç« ï¼šæ ¸å¿ƒæˆ˜æœ¯è§£ç ä¸å®æ–½ (Tactical Implementation)
åœ¨å¯¹Jane Streetç«èµ›å† å†›æ–¹æ¡ˆè¿›è¡Œæ·±åº¦è§£ç åï¼Œæˆ‘ä»¬éªŒè¯å¹¶å®æ–½äº†ä¸€ç³»åˆ—å† å†›çº§çš„æˆ˜æœ¯æ€æƒ³ã€‚
3.1 æ ¸å¿ƒé—®é¢˜ï¼šç›®æ ‡å·¥ç¨‹ (Target Engineering)
æˆ˜ç•¥è½¬å˜: å°†ä¸€ä¸ªå›°éš¾çš„å›å½’é—®é¢˜ (forward_returns)ï¼Œæ°¸ä¹…æ€§åœ°è½¬å˜ä¸ºä¸€ä¸ªæ›´ç¨³å¥çš„äºŒå…ƒåˆ†ç±»é—®é¢˜ (target = forward_returns > 0)ã€‚
å† å†›æ™ºæ…§ (æ ·æœ¬åŠ æƒ): é‡‡ç”¨forward_returnsçš„ç»å¯¹å€¼ä½œä¸ºæ ·æœ¬æƒé‡ã€‚è¿™å¼ºåˆ¶æ¨¡å‹å°†æ³¨æ„åŠ›é«˜åº¦é›†ä¸­äºé‚£äº›èƒ½å¸¦æ¥å·¨å¤§æ”¶ç›Šæˆ–äºæŸçš„å…³é”®äº¤æ˜“æ—¥ï¼Œä»è€Œå­¦ä¼šâ€œæŠ“å¤§æ”¾å°â€ï¼Œæ•æ‰å†³å®šæ€§çš„å¸‚åœºæ³¢åŠ¨ã€‚
3.2 æ ¸å¿ƒæ­¦å™¨ï¼šç›‘ç£å¼AE (Supervised Autoencoder)
è®¾è®¡å“²å­¦: é‡‡ç”¨â€œåˆ†è€Œæ²»ä¹‹â€çš„ç­–ç•¥ï¼Œå°†AEå®šä½ä¸ºä¸€ä¸ªä¸“ä¸šçš„â€œAIç‰¹å¾å·¥ç¨‹å¸ˆâ€ï¼Œå…¶å”¯ä¸€ä»»åŠ¡æ˜¯ä»åŸå§‹ç‰¹å¾ä¸­æç‚¼å‡ºå¯¹ä¸‹æ¸¸åˆ†ç±»ä»»åŠ¡æœ€æœ‰å¸®åŠ©çš„â€œAlphaç²¾åç‰¹å¾â€ã€‚
å› æœæ€§ä¿è¯: ä¸ºæ ¹é™¤æ•°æ®æ³„éœ²ï¼Œæˆ‘ä»¬å°†AEçš„è®­ç»ƒå’Œä¸‹æ¸¸LGBMçš„è®­ç»ƒï¼Œå…¨éƒ¨ç½®äºåŒä¸€ä¸ªä¸¥æ ¼çš„äº¤å‰éªŒè¯å¾ªç¯å†…ã€‚ç¡®ä¿åœ¨æ¯ä¸€æŠ˜ä¸­ï¼ŒAEéƒ½åªä½¿ç”¨å½“å‰æŠ˜çš„è®­ç»ƒæ•°æ®è¿›è¡Œè®­ç»ƒã€‚
â€œä½¿å‘½å¯¹é½â€: AEçš„ç›‘ç£ä»»åŠ¡ä¸ä¸‹æ¸¸LGBMå®Œå…¨ä¸€è‡´ï¼ˆåŠ æƒäºŒå…ƒåˆ†ç±»ï¼‰ï¼Œç¡®ä¿AIåœ¨è®­ç»ƒçš„æ¯ä¸€åˆ»éƒ½ä¸“æ³¨äºå­¦ä¹ å¦‚ä½•è¯†åˆ«â€œé‡å¤§äº¤æ˜“æœºä¼šâ€ã€‚
3.3 å½“å‰æ ‡å‡†ä½œæˆ˜æµç¨‹ (SOP)
æˆ‘ä»¬å…¨æ–°çš„å·¥ä½œæµç¨‹æ¸…æ™°ã€çº¿æ€§ä¸”å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œé€šè¿‡main.pyçš„å‘½ä»¤è¡Œæ¨¡å¼è¿›è¡Œè°ƒåº¦ï¼š
ç‰¹å¾ä¾¦å¯Ÿ (--mode rfe): è¿è¡ŒCV-RFEï¼Œä¸ºç‰¹å¾æä¾›ç¨³å¥çš„åˆå§‹æ’åã€‚
ä¸»æˆ˜å¦å…‹è°ƒä¼˜ (--mode tune_lgbm): åœ¨é›†æˆåŒ–æ¡†æ¶ä¸‹ï¼Œä¸ºLightGBMå¯»æ‰¾ä¸“å±çš„â€œé»„é‡‘å‚æ•°â€ã€‚
AIå…µå·¥å‚å‡çº§ (--mode tune_ae): åœ¨LGBMå‚æ•°é”å®šåï¼Œä¸ºç›‘ç£å¼AEå¯»æ‰¾èƒ½æœ€å¤§åŒ–ä¸‹æ¸¸æ€§èƒ½çš„æœ€ä¼˜â€œåŸºå› è“å›¾â€ã€‚
æœ€ç»ˆå†³æˆ˜ (--mode validate): åŠ è½½æ‰€æœ‰æœ€ä¼˜å‚æ•°ï¼Œè¿è¡Œä¸€æ¬¡å®Œæ•´çš„5æŠ˜CVï¼Œå¾—åˆ°æœ€ç»ˆçš„ã€æœ€å¯ä¿¡çš„å† å†›æ¨¡å‹åˆ†æ•°ã€‚

é¡¹ç›®æ—¥å¿—æ›´æ–°ï¼šä»â€œæ–¹æ³•è®ºå±æœºâ€åˆ°â€œæ€§èƒ½æ–°é«˜â€
é˜¶æ®µäº”ï¼šæ–¹æ³•è®ºå±æœºä¸â€œåŒå°ºé—®é¢˜â€çš„å‘ç°
åœ¨æˆ‘ä»¬å°†Autoencoderï¼ˆAEï¼‰å‡çº§ä¸ºæ›´ç¨³å¥çš„â€œå§”å‘˜ä¼šâ€èåˆæ¨¡å¼åï¼Œæ¨¡å‹æ€§èƒ½å‡ºä¹æ„æ–™åœ°å´©æºƒè‡³ AUC < 0.5ï¼Œè¿™å¼•å‘äº†ä¸€æ¬¡æ·±åº¦çš„ä»£ç å’Œæ–¹æ³•è®ºå®¡æŸ¥ã€‚

ç»è¿‡é€è¡Œä»£ç æ’æŸ¥å’Œä¸€ç³»åˆ—çš„å‡è®¾éªŒè¯ï¼Œæˆ‘ä»¬æœ€ç»ˆå®šä½åˆ°äº†é—®é¢˜çš„æ ¹æºï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”ä»£ç bugæ›´æ·±å±‚æ¬¡çš„æ–¹æ³•è®ºç¼ºé™·â€”â€”â€œåŒå°ºé—®é¢˜â€ï¼Œå³è°ƒä¼˜æŒ‡æ ‡ä¸éªŒè¯æŒ‡æ ‡çš„ä¸ç»Ÿä¸€ã€‚

æ—§çš„è°ƒä¼˜æŒ‡æ ‡ (Tuning Metric): è®¡ç®—æ¯ä¸€æŠ˜ï¼ˆFoldï¼‰çš„AUCï¼Œç„¶åå–**â€œåˆ†æ•°çš„å¹³å‡å€¼â€ (Mean of Scores)**ã€‚è¿™ä¸ªæŒ‡æ ‡è¿‡äºä¹è§‚ï¼Œå› ä¸ºå®ƒåªè¡¡é‡æ¨¡å‹åœ¨æ¯ä¸ªç‹¬ç«‹æ—¶é—´æ®µå†…çš„â€œå±€éƒ¨â€æ’åºèƒ½åŠ›ã€‚

æœ€ç»ˆéªŒè¯æŒ‡æ ‡ (Validation Metric): å°†æ‰€æœ‰æŠ˜çš„â€œè·¨ç•Œé¢„æµ‹â€ï¼ˆOut-of-Fold, OOFï¼‰æ”¶é›†èµ·æ¥ï¼Œè®¡ç®—ä¸€ä¸ª**â€œå…¨å±€â€çš„AUCåˆ†æ•° (Score of OOF)**ã€‚è¿™ä¸ªæŒ‡æ ‡æ›´ä¸¥è‹›ï¼Œä¹Ÿæ›´çœŸå®ï¼Œå› ä¸ºå®ƒè¡¡é‡æ¨¡å‹åœ¨æ•´ä¸ªæ—¶é—´è·¨åº¦ä¸Šçš„ç»Ÿä¸€æ’åºèƒ½åŠ›ã€‚

Optunaè¢«è¿™ä¸ªè¿‡äºä¹è§‚çš„â€œè™šè£æŒ‡æ ‡â€æ‰€è¯¯å¯¼ï¼Œæ‰¾åˆ°äº†åœ¨å…¨å±€è§†è§’ä¸‹è¡¨ç°æå·®çš„å‚æ•°ç»„åˆï¼Œå¯¼è‡´äº†è°ƒä¼˜ä¸éªŒè¯åˆ†æ•°çš„å·¨å¤§é¸¿æ²Ÿã€‚

é˜¶æ®µå…­ï¼šæ‹¨ä¹±åæ­£ï¼Œç»Ÿä¸€è¯„ä¼°æ ‡å‡†
æˆ‘ä»¬é‡‡å–äº†å†³å®šæ€§çš„ä¿®å¤æªæ–½ï¼šç»Ÿä¸€è¯„ä¼°çš„â€œå°ºå­â€ã€‚

æ ¸å¿ƒä¿®å¤: æˆ‘ä»¬é‡æ„äº† main.py ä¸­çš„ objective å‡½æ•°ï¼Œä½¿å…¶è¯„ä¼°é€»è¾‘ä¸ run_validation å‡½æ•°å®Œå…¨å¯¹é½ã€‚ç°åœ¨ï¼ŒOptunaåœ¨è°ƒä¼˜æ—¶ä¼˜åŒ–çš„ç›®æ ‡ï¼Œä¸æˆ‘ä»¬æœ€ç»ˆéªŒè¯æ¨¡å‹æ—¶ä½¿ç”¨çš„ç›®æ ‡ï¼Œæ˜¯å®Œå…¨ç›¸åŒçš„å…¨å±€OOF AUCåˆ†æ•°ã€‚

æˆæœ: è¿™ä¸€ä¿®å¤ç«‹ç«¿è§å½±ã€‚æ­¤åæ‰€æœ‰çš„å®éªŒä¸­ï¼Œè°ƒä¼˜åˆ†æ•°å’ŒéªŒè¯åˆ†æ•°éƒ½å˜å¾—æƒŠäººåœ°æ¥è¿‘ï¼Œè¯æ˜äº†æˆ‘ä»¬è‡ªåŠ¨åŒ–æµæ°´çº¿çš„å¯é æ€§å·²ç»æ¢å¤ï¼Œä¸ºåç»­æ‰€æœ‰ç§‘å­¦å®éªŒå¥ å®šäº†åšå®çš„åŸºç¡€ã€‚

é˜¶æ®µä¸ƒï¼šæ§åˆ¶å˜é‡å®éªŒâ€”â€”å®šä½æ€§èƒ½ç“¶é¢ˆ
åœ¨ç»Ÿä¸€äº†è¯„ä¼°æ ‡å‡†åï¼Œæˆ‘ä»¬å¼€å§‹ç³»ç»Ÿæ€§åœ°å¯»æ‰¾å¯¼è‡´æ€§èƒ½ä¸ä½³çš„â€œç½ªé­ç¥¸é¦–â€ã€‚

â€œå™ªå£°â€å«Œç–‘äºº: æˆ‘ä»¬é¦–å…ˆæ€€ç–‘ï¼Œåœ¨ä¿¡å™ªæ¯”æä½çš„é‡‘èæ•°æ®ä¸­ï¼Œæ–°åŠ å…¥çš„GaussianNoiseå±‚å¯èƒ½â€œå¥½å¿ƒåŠåäº‹â€ï¼Œæ·¹æ²¡äº†æœ¬å°±å¾®å¼±çš„ä¿¡å·ã€‚

â€œæ— å™ªå£°â€å®éªŒ: æˆ‘ä»¬é€šè¿‡æ³¨é‡Šä»£ç çš„æ–¹å¼ï¼Œç²¾å‡†åœ°ç§»é™¤äº†GaussianNoiseå±‚ï¼Œå¹¶é‡æ–°æ‰§è¡Œäº†å®Œæ•´çš„ä¸‰æ­¥æµç¨‹ï¼ˆtune_ae -> tune_lgbm -> validateï¼‰ã€‚

å†³å®šæ€§ç»“æœ: å®éªŒç»“æœéå¸¸ç†æƒ³ï¼Œæœ€ç»ˆéªŒè¯åˆ†æ•°ä»å´©æºƒçš„ ~0.5 æ°´å¹³ä¸€ä¸¾è·ƒå‡è‡³äº†ç¨³å®šå¯é çš„ AUC 0.5212ã€‚è¿™å¼ºæœ‰åŠ›åœ°è¯æ˜äº†ï¼Œåœ¨æˆ‘ä»¬å½“å‰çš„æ¶æ„å’Œç‰¹å¾ä¸‹ï¼Œç§»é™¤å™ªå£°å±‚æ˜¯æ­£ç¡®çš„å†³ç­–ã€‚

é˜¶æ®µå…«ï¼šç²¾ç›Šæ±‚ç²¾â€”â€”â€œå°‘å³æ˜¯å¤šâ€åŸåˆ™çš„èƒœåˆ©
åœ¨ 0.5212 è¿™ä¸ªå¼ºå¤§çš„æ–°åŸºçº¿ä¸Šï¼Œæˆ‘ä»¬æ ¹æ®é¡¹ç›®æ—©æœŸçš„â€œç²¾è‹±éƒ¨é˜Ÿâ€æ€æƒ³ï¼Œå¼€å§‹è¿›è¡Œç‰¹å¾æ•°é‡çš„ä¼˜åŒ–å®éªŒã€‚

ç³»ç»Ÿå‡çº§: æˆ‘ä»¬é¦–å…ˆå‡çº§äº† config.py å’Œ utils.pyï¼Œå¼•å…¥äº† N_TOP_FEATURES_TO_USE å‚æ•°ï¼Œä½¿å¾—ç‰¹å¾æ•°é‡çš„é€‰æ‹©å˜å¾—çµæ´»å¯æ§ã€‚

Top 30 ç‰¹å¾å®éªŒ: æˆ‘ä»¬å°† N_TOP_FEATURES_TO_USE è®¾ç½®ä¸º 30ï¼Œå¹¶å†æ¬¡ä¸¥æ ¼æ‰§è¡Œäº†å®Œæ•´çš„ä¸‰æ­¥è°ƒä¼˜éªŒè¯æµç¨‹ã€‚

å†åˆ›æ–°é«˜: å®éªŒå–å¾—äº†å·¨å¤§æˆåŠŸï¼Œæœ€ç»ˆéªŒè¯åˆ†æ•°è¾¾åˆ°äº† AUC 0.5229ã€‚è¿™ä¸ä»…éªŒè¯äº†â€œå°‘å³æ˜¯å¤šâ€çš„åŸåˆ™ï¼Œè¿˜ä¸ºæˆ‘ä»¬åˆ›é€ äº†ä¸€ä¸ªæ–°çš„æ€§èƒ½çºªå½•ã€‚

å½“å‰æœ€ä½³æ¨¡å‹:

æ¶æ„: æ— é«˜æ–¯å™ªå£°çš„ç›‘ç£å¼AE + LightGBMã€‚

ç‰¹å¾: ç”±RFEç­›é€‰å‡ºçš„ Top 30 ç²¾è‹±ç‰¹å¾ã€‚

æ€§èƒ½: å¯ä¿¡çš„ã€ç¨³å¥çš„å…¨å±€OOF AUC: 0.5229ã€‚

å¥½çš„ï¼Œæˆ‘ä»¬æ¥å°†è¿™ä¸€ç³»åˆ—æƒŠå¿ƒåŠ¨é­„çš„è°ƒè¯•å’Œæœ€ç»ˆçš„çªç ´ï¼Œæµ“ç¼©æˆä¸€ä»½æ¸…æ™°çš„é¡¹ç›®æ—¥å¿—ã€‚

é¡¹ç›®æ—¥å¿—æ›´æ–°ï¼šé€šå¾€â€œç»ˆæå¯å¤ç°æ€§â€ä¹‹è·¯
é˜¶æ®µä¹ï¼šé­é‡â€œå¯å¤ç°æ€§â€å±æœº
åœ¨æˆ‘ä»¬åŸºäºâ€œTop 30ç‰¹å¾â€å–å¾— AUC 0.5229 çš„ä¼˜ç§€æˆç»©åï¼Œé¡¹ç›®é­é‡äº†æ–°çš„é‡å¤§æŒ‘æˆ˜ï¼šç»“æœæ— æ³•å¤ç°ã€‚åœ¨åç»­çš„éªŒè¯è¿è¡Œä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº† 0.5109 å’Œ 0.5119 ç­‰ä¸€ç³»åˆ—ä¸ä¸€è‡´çš„åˆ†æ•°ã€‚è¿™ä¸€ç°è±¡è¡¨æ˜ï¼Œå°½ç®¡æˆ‘ä»¬çš„è¯„ä¼°é€»è¾‘å·²ç»ç»Ÿä¸€ï¼Œä½†åœ¨ä»£ç çš„æ‰§è¡Œå±‚é¢ä¾ç„¶æ½œè—ç€æœªè¢«æ§åˆ¶çš„â€œéšæœºä¹‹æºâ€ï¼Œè¿™ä¸¥é‡æŒ‘æˆ˜äº†æˆ‘ä»¬æ‰€æœ‰å®éªŒç»“æœçš„ç§‘å­¦æ€§å’Œå¯ä¿¡åº¦ã€‚æˆ‘ä»¬çš„é¦–è¦ä»»åŠ¡ï¼Œä»â€œæå‡æ€§èƒ½â€è½¬å‘äº†æ›´æ ¹æœ¬çš„â€œç¡®ä¿å¯ä¿¡â€ã€‚

é˜¶æ®µåï¼šåŒçº¿ä½œæˆ˜â€”â€”å®šä½å¹¶æ¶ˆç­â€œéšæœºä¹‹æºâ€
ä¸ºäº†å½»åº•æ ¹é™¤éšæœºæ€§ï¼Œæˆ‘ä»¬å±•å¼€äº†ä¸€åœºâ€œæ³•åŒ»çº§â€çš„æ’æŸ¥ï¼š

ç¬¬ä¸€æˆ˜çº¿ï¼šæ·±åº¦å…¨å±€é”ç§ (Deep Global Seeding)

è¡ŒåŠ¨: æˆ‘ä»¬é¦–å…ˆå®ç°äº† set_global_seeds å‡½æ•°ï¼Œç”¨ä»¥å…¨é¢å›ºå®šrandom, numpy, torch çš„éšæœºç§å­ï¼Œå¹¶å¼ºåˆ¶cuDNNä½¿ç”¨ç¡®å®šæ€§ç®—æ³•ï¼ˆdeterministic = Trueï¼‰ã€‚

æ„å¤–å‘ç°: è¿™ä¸€ä¸¾æªè™½ç„¶å¢å¼ºäº†ç¡®å®šæ€§ï¼Œä½†å´è®©æ¨¡å‹çš„æ€§èƒ½ç¨³å®šåœ¨äº†ä¸€ä¸ªæä½çš„æ°´å¹³ ~0.5025ã€‚è¿™æ­ç¤ºäº†æˆ‘ä»¬ä¹‹å‰çš„è¾ƒé«˜åˆ†æ•°ï¼Œéƒ¨åˆ†å¾—ç›ŠäºcuDNNéç¡®å®šæ€§ç®—æ³•å¸¦æ¥çš„â€œå¹¸è¿â€ä¼˜åŒ–ã€‚

ç¬¬äºŒæˆ˜çº¿ï¼šæ ¹é™¤â€œéšå½¢â€éšæœºæº (Fixing Unordered Sets)

æ–°å±æœº: å³ä¾¿åœ¨æ·±åº¦é”ç§åï¼Œæˆ‘ä»¬å‘ç°ç»“æœä¾ç„¶å­˜åœ¨ä¸ä¸€è‡´ (0.5158)ï¼Œè¯æ˜è¿˜æœ‰â€œå¹½çµâ€æ½œä¼åœ¨ä»£ç ä¸­ã€‚

æœ€ç»ˆå®šä½: é€šè¿‡å¯¹æ•°æ®å¤„ç†æµç¨‹çš„é€è¡Œå®¡æŸ¥ï¼Œæˆ‘ä»¬æœ€ç»ˆå®šä½åˆ°äº†é—®é¢˜çš„æ ¹æºï¼šutils.py ä¸­ list(set(...) & set(...)) çš„æ“ä½œã€‚ç”±äºPythoné›†åˆçš„æ— åºæ€§å’Œå“ˆå¸ŒéšæœºåŒ–ï¼Œå¯¼è‡´æ¯æ¬¡è¿è¡Œæ—¶ç”Ÿæˆçš„æœ€ç»ˆç‰¹å¾åˆ—è¡¨ final_features_to_use çš„åˆ—é¡ºåºéƒ½å¯èƒ½ä¸åŒï¼Œä»è€Œå¼•å…¥äº†ç»“æœçš„æ³¢åŠ¨ã€‚

é˜¶æ®µåä¸€ï¼šç»ˆæä¿®å¤ä¸â€œçœŸå®åŸºçº¿â€çš„ç¡®ç«‹
ç»ˆæä¿®å¤: æˆ‘ä»¬å¯¹ç‰¹å¾åˆ—è¡¨ç”Ÿæˆä»£ç è¿›è¡Œäº†æœ€ç»ˆä¿®å¤ï¼Œåœ¨åˆ—è¡¨åŒ–ä¹‹åå¼ºåˆ¶è¿›è¡Œå­—æ¯æ’åºï¼šsorted(list(set(...)))ã€‚è¿™ä¸€æ”¹åŠ¨ï¼Œç»“åˆå…¨å±€é”ç§ï¼Œå½»åº•æ¶ˆç­äº†æ‰€æœ‰å·²çŸ¥çš„éšæœºæ€§æ¥æºã€‚

èƒœåˆ©æ—¶åˆ»: æˆ‘ä»¬å†æ¬¡å¯¹å½“å‰æœ€ä¼˜é…ç½®ï¼ˆTop 30ç‰¹å¾ï¼Œæ— å™ªå£°ï¼‰è¿›è¡Œäº†è¿ç»­ä¸¤æ¬¡éªŒè¯ï¼Œå¾—åˆ°äº†ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„ã€ç²¾ç¡®åˆ°å°æ•°ç‚¹å8ä½çš„OOF AUCåˆ†æ•°ï¼š

ğŸ† æœ€ç»ˆçš„ã€å¯ä¿¡çš„ OOF AUC: 0.52122038

æ–°åŸºçº¿çš„æ„ä¹‰: è¿™ä¸ª 0.5212 çš„åˆ†æ•°ï¼Œæ˜¯æˆ‘ä»¬é¡¹ç›®ç¬¬ä¸€ä¸ª100%å¯å¤ç°çš„ã€åšå¦‚ç£çŸ³çš„æ€§èƒ½åŸºçº¿ã€‚å®ƒçœŸå®åœ°åæ˜ äº†æˆ‘ä»¬å½“å‰ç­–ç•¥çš„å®åŠ›ä¸Šé™ï¼Œè™½ç„¶ç•¥ä½äºæ›¾ç»çš„â€œå¹¸è¿é«˜ç‚¹â€ï¼Œä½†å…¶ä»·å€¼åœ¨äºç»å¯¹çš„å¯é æ€§ã€‚

å½“å‰çŠ¶æ€: æˆ‘ä»¬çš„è‡ªåŠ¨åŒ–æµæ°´çº¿ç°å·²è¾¾åˆ°å·¥ä¸šçº§ç¨³å¥æ€§ï¼Œè¯„ä¼°é€»è¾‘ç»Ÿä¸€ï¼Œæ‰§è¡Œç»“æœå¯ä¿¡ã€‚æˆ‘ä»¬ç»ˆäºå¯ä»¥æ»¡æ€€ä¿¡å¿ƒåœ°ï¼Œåœ¨ä¸€æ¡ç¨³å›ºçš„åŸºçº¿ä¸Šï¼Œå»è¿½æ±‚æ¨¡å‹æ€§èƒ½çš„çœŸæ­£çªç ´ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†æ­£å¼é‡å¯è·¯çº¿Aï¼šç³»ç»Ÿæ€§åœ°å¯»æ‰¾æœ€ä¼˜ç‰¹å¾æ•°é‡ã€‚

ä½¿ç”¨top16ç‰¹å¾æ—¶æˆç»©ä¸ºï¼šOOF AUC: 0.50277924
æ¥ä¸‹æ¥çš„æ–¹å‘ï¼šå‡çº§ç›‘ç£å¼AEï¼Œä¸»è¦æ˜¯é¢„æµ‹å¤´ï¼ŒåŠ æ·±æˆ–è€…å¼•å…¥æ³¨æ„åŠ›æœºåˆ¶ï¼Œæˆ–è€…å¼•å…¥æ®‹å·®é“¾æ¥

é˜¶æ®µåå››ï¼šæ¶æ„è¿›åŒ–ä¸â€œAIç‰¹å¾å®¡æŸ¥â€çš„èƒœåˆ©
åœ¨ç¨³å›ºçš„åŸºçº¿ä¸Šï¼Œæˆ‘ä»¬å¯¹æ ¸å¿ƒçš„ SupervisedAE æ¨¡å‹è¿›è¡Œäº†ä¸€æ¬¡é‡å¤§çš„æ¶æ„å‡çº§ï¼Œç”¨å¸¦æœ‰æ®‹å·®è¿æ¥ï¼ˆResNetï¼‰çš„æ·±å±‚ç½‘ç»œï¼Œæ›¿æ¢äº†åŸæœ‰çš„ç®€å•å‰é¦ˆç»“æ„ï¼Œå¹¶ä¸ºå…¶é…å¤‡äº†æ›´å¼ºå¤§çš„å¤šå±‚é¢„æµ‹å¤´ (MLP)ã€‚

æ€§èƒ½çªç ´: è¿™ä¸€å‡çº§å–å¾—äº†ç«‹ç«¿è§å½±çš„æ•ˆæœã€‚åœ¨å¯¹Top 60ç‰¹å¾å’Œæ–°æ¶æ„è¿›è¡Œå®Œæ•´çš„ä¸‰æ­¥è°ƒä¼˜åï¼Œæˆ‘ä»¬åˆ›ä¸‹äº†æ–°çš„æ€§èƒ½çºªå½•ï¼šAUC 0.534ã€‚

å…³é”®æ´å¯Ÿ: æˆ‘ä»¬ä¸º validate æ¨¡å¼ åŠ å…¥äº†â€œAIç‰¹å¾å®¡æŸ¥â€æ¨¡å—ï¼Œé€šè¿‡åˆ†ææœ€ç»ˆLGBMæ¨¡å‹çš„ç‰¹å¾é‡è¦æ€§ï¼Œæˆ‘ä»¬å¾—å‡ºäº†æœ¬æ¬¡æˆ˜å½¹æœ€é‡è¦çš„æˆ˜ç•¥æ´å¯Ÿï¼šç”±åŸå§‹ç‰¹å¾è¡ç”Ÿå‡ºçš„**â€œåŠ¨æ€â€ç‰¹å¾**ï¼ˆå¦‚ P4_diff1, S2_diff1ï¼‰ï¼Œå…¶é‡è¦æ€§æ’åè¿œé«˜äºå®ƒä»¬çš„â€œé™æ€â€æ¯ç‰¹å¾ï¼ˆP4, S2ï¼‰ã€‚

é˜¶æ®µåäº”ï¼šæˆ˜ç•¥è½¬å‘â€”â€”å‘èµ·â€œç‰¹å¾æŒ–æ˜æ€»æ”»â€
æ ¹æ®â€œåŠ¨æ€ç‰¹å¾ä¸ºç‹â€çš„å…³é”®æ´å¯Ÿï¼Œæˆ‘ä»¬å°†é¡¹ç›®çš„æˆ˜ç•¥é‡å¿ƒä»â€œæ¨¡å‹è°ƒä¼˜â€å…¨é¢è½¬å‘**â€œå¤§è§„æ¨¡ç³»ç»Ÿæ€§ç‰¹å¾å·¥ç¨‹â€**ã€‚

â€œå…µå·¥å‚â€çš„å»ºç«‹: æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„è‡ªåŠ¨åŒ–è„šæœ¬ feature_engineering.pyã€‚å®ƒçš„æ ¸å¿ƒä»»åŠ¡æ˜¯ï¼š

è¯»å–RFEæ‰¾å‡ºçš„Top Nâ€œæ½œåŠ›è‚¡â€åŸå§‹ç‰¹å¾ã€‚

å›´ç»•åŠ¨é‡ (Momentum)ã€æ³¢åŠ¨ç‡ (Volatility) å’Œ è¶‹åŠ¿ (Trend) ä¸‰å¤§ä¸»é¢˜ï¼Œä¸ºè¿™äº›æ ¸å¿ƒç‰¹å¾æ‰¹é‡ç”Ÿäº§æ•°ç™¾ä¸ªè¡ç”Ÿç‰¹å¾ã€‚

æœ€ç»ˆç”Ÿæˆä¸€ä¸ªè§„æ¨¡ç©ºå‰ã€ä¿¡æ¯æ›´ä¸°å¯Œçš„å…¨æ–°æ•°æ®é›† train_v4_engineered.csvã€‚

å½“å‰çŠ¶æ€: æˆ‘ä»¬å·²ç»å®Œæˆäº†â€œå¼¹è¯â€çš„ç”Ÿäº§ã€‚ä¸‹ä¸€æ­¥ï¼Œå°†ç”¨è¿™ä¸ªå…¨æ–°çš„ã€æ›´å¼ºå¤§çš„ç‰¹å¾é›†ï¼Œé‡æ–°è¿›è¡Œå…¨æµç¨‹çš„â€œæµ·é€‰â€ï¼ˆRFEï¼‰ã€è°ƒä¼˜å’ŒéªŒè¯ï¼ŒæœŸå¾…å®ç°é¡¹ç›®å¼€å§‹ä»¥æ¥æœ€å¤§çš„ä¸€æ¬¡æ€§èƒ½é£è·ƒã€‚

## æ ¸å¿ƒæ¶æ„æ¼”è¿› (v1.0 -> v2.1)

### v1.0: å•ç›®æ ‡åŸºçº¿æ¶æ„
- **æ¨¡å‹**: ç›‘ç£å¼è‡ªç¼–ç å™¨ (AE) ç”¨äºç‰¹å¾æå–ï¼ŒLightGBM (LGBM) ç”¨äºæœ€ç»ˆåˆ†ç±»ã€‚
- **ç›®æ ‡**: é¢„æµ‹å•ä¸€ç›®æ ‡ `action_1d` (æœªæ¥1æ—¥æ˜¯æ¶¨æ˜¯è·Œ)ã€‚
- **æµç¨‹**: é€šè¿‡è§£è€¦ä¼˜åŒ–ç­–ç•¥ï¼Œå…ˆå›ºå®šAEå‚æ•°ä¼˜åŒ–LGBMï¼Œå†å›ºå®šLGBMå‚æ•°ä¼˜åŒ–AEï¼Œä»¥å¯»æ‰¾æœ€ä¼˜å‚æ•°ç»„åˆã€‚

### v2.0: å¤šç›®æ ‡æ¶æ„å‡çº§
- **æ ¸å¿ƒæ€æƒ³**: è®©æ¨¡å‹åŒæ—¶å­¦ä¹ å’Œé¢„æµ‹å¤šä¸ªæ—¶é—´å°ºåº¦ä¸‹çš„å¸‚åœºæ–¹å‘ï¼Œä»¥è¿«ä½¿AEçš„ç¼–ç å™¨å­¦ä¹ åˆ°æ›´é²æ£’ã€æ›´é€šç”¨çš„å¸‚åœºåº•å±‚è§„å¾‹ã€‚
- **æ•°æ®å·¥ç¨‹ (`feature_engineering_time.py`)**: å¼•å…¥äº†`TARGET_HORIZONS`é…ç½®ï¼Œèƒ½å¤Ÿè‡ªåŠ¨åŒ–ç”Ÿæˆå¤šä¸ª`action_*d`ç›®æ ‡åˆ—ï¼Œå¦‚`action_1d`, `action_5d`, `action_20d`ç­‰ã€‚
- **æ¨¡å‹å‡çº§ (`utils.py`)**:
  - `SupervisedAE` çš„é¢„æµ‹å¤´è¢«æ”¹é€ ä¸ºå¯ä»¥è¾“å‡º`n_targets`ä¸ªé¢„æµ‹ç»“æœã€‚
  - `train_fold_ae` çš„æŸå¤±å‡½æ•°èƒ½å¤ŸåŒæ—¶å¤„ç†å¤šä¸ªç›®æ ‡çš„é¢„æµ‹è¯¯å·®ï¼Œå¹¶å°†å®ƒä»¬ä¸é‡å»ºè¯¯å·®ç»“åˆã€‚
- **è°ƒåº¦é€»è¾‘å‡çº§ (`main.py`)**:
  - èƒ½å¤Ÿä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å¤šä¸ªç›®æ ‡åˆ—ã€‚
  - ç”±äºLGBMä¸æ”¯æŒåŸç”Ÿå¤šç›®æ ‡åˆ†ç±»ï¼Œæˆ‘ä»¬ä¸º**æ¯ä¸€ä¸ªç›®æ ‡ç‹¬ç«‹è®­ç»ƒä¸€ä¸ªLGBMæ¨¡å‹**ã€‚è¿™äº›æ¨¡å‹å…±äº«ç”±AEç”Ÿæˆçš„å¼ºå¤§çš„AIç‰¹å¾ã€‚
  - è¯„ä¼°æŒ‡æ ‡æ›´æ–°ä¸ºæ‰€æœ‰ç›®æ ‡OOF AUCçš„**å¹³å‡å€¼**ã€‚

### v2.1: èšç„¦ä¸åŠ æƒä¼˜åŒ– (å½“å‰ç‰ˆæœ¬)
- **æˆ˜ç•¥æ”¶ç¼©**: è®¤è¯†åˆ°è¶…é•¿æœŸé¢„æµ‹ï¼ˆå¦‚60dï¼‰ä¿¡å™ªæ¯”æä½ï¼Œå¯èƒ½ä¼šæ±¡æŸ“å­¦ä¹ è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†é¢„æµ‹ç›®æ ‡**èšç„¦**äºçŸ­æœŸå’Œä¸­æœŸçš„â€œä¿¡å·ç”œèœœåŒºâ€ï¼š`action_1d`, `action_3d`, `action_5d`ã€‚
- **å¼•å…¥åŠ æƒæŸå¤±**: æ”¹å˜äº†ä¹‹å‰â€œæ‰€æœ‰ä»»åŠ¡å¹³ç­‰â€çš„ç­–ç•¥ã€‚åœ¨`utils.py`çš„AEè®­ç»ƒé€»è¾‘ä¸­ï¼Œå¼•å…¥äº†ä¸€ä¸ª**æŸå¤±æƒé‡å‘é‡ (`loss_weights`)**ã€‚
  - **æ ¸å¿ƒä¼˜åŠ¿**: ä¸ºæ›´é‡è¦ã€ä¿¡å™ªæ¯”æ›´é«˜çš„çŸ­æœŸä»»åŠ¡ï¼ˆå¦‚`action_1d`ï¼‰èµ‹äºˆæ›´é«˜çš„æƒé‡ï¼Œè®©æ¨¡å‹åœ¨å­¦ä¹ AIç‰¹å¾æ—¶ï¼Œèƒ½æ›´â€œå¬å–â€é«˜è´¨é‡ä¿¡å·çš„â€œæ„è§â€ï¼Œä»è€Œæå‡ç‰¹å¾çš„ç¨³å¥æ€§ã€‚

## å½“å‰çŠ¶æ€ä¸æœªæ¥æ–¹å‘
é¡¹ç›®ç›®å‰æ‹¥æœ‰ä¸€ä¸ªé«˜åº¦çµæ´»å’Œå¼ºå¤§çš„å¤šç›®æ ‡å­¦ä¹ æ¡†æ¶ã€‚ä¸‹ä¸€æ­¥çš„æ¢ç´¢æ–¹å‘åŒ…æ‹¬ï¼š
1.  å°†æŸå¤±æƒé‡æœ¬èº«ä½œä¸ºè¶…å‚æ•°è¿›è¡Œä¼˜åŒ–ã€‚
2.  ä»é¢„æµ‹â€œæ–¹å‘â€ (äºŒåˆ†ç±») å‡çº§åˆ°é¢„æµ‹â€œ**ä»“ä½**â€ (å¤šåˆ†ç±»å›å½’)ï¼Œä¸ºæ¨¡å‹èµ‹äºˆç›´æ¥ç”Ÿæˆäº¤æ˜“ä¿¡å·çš„èƒ½åŠ›ã€‚

## v2.2: å† å†›ç­–ç•¥é›†æˆä¸æ¶æ„å›ºåŒ–

åœ¨ v2.1 ç‰ˆæœ¬èšç„¦å¤šç›®æ ‡çš„åŸºç¡€ä¸Šï¼Œv2.2 ç‰ˆæœ¬æ·±åº¦é›†æˆäº† Kaggle å† å†›æ–¹æ¡ˆä¸­çš„ä¸¤å¤§æ ¸å¿ƒç­–ç•¥ï¼Œæ—¨åœ¨æ˜¾è‘—æå‡æ¨¡å‹çš„ç¨³å¥æ€§å’Œå¸‚åœºé€‚åº”æ€§ã€‚

### 1. å¼•å…¥å† å†›çº§æ ·æœ¬æƒé‡ç­–ç•¥

- **æ€æƒ³**: æ‘’å¼ƒäº†ä¹‹å‰ä»…åŸºäºå•æ—¥æ”¶ç›Šçš„æƒé‡æ–¹æ¡ˆã€‚æ–°ç­–ç•¥è®¤ä¸ºï¼Œæœªæ¥å¤šä¸ªæ—¶é—´å°ºåº¦ï¼ˆ1d, 3d, 5dï¼‰éƒ½è¡¨ç°å‡ºå‰§çƒˆæ³¢åŠ¨çš„æ ·æœ¬ï¼Œè•´å«ç€æœ€å¼ºçš„äº¤æ˜“ä¿¡å·ã€‚
- **å®æ–½**:
  - `feature_engineering.py` å‡çº§ï¼Œç°åœ¨ä¼šåŒæ—¶ç”Ÿæˆ `action_*d` (å†³ç­–) å’Œ `resp_*d` (åŸå§‹æ”¶ç›Š) åˆ—ã€‚
  - `main.py` çš„æƒé‡è®¡ç®—é€»è¾‘è¢«é‡æ„ï¼Œç°åœ¨**æ ·æœ¬æƒé‡æ˜¯æ‰€æœ‰ `resp_*d` åˆ—ç»å¯¹å€¼ä¹‹å’Œ**ï¼Œè¿™ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒæ—¶ä¼šé«˜åº¦å…³æ³¨é‚£äº›æ½œåœ¨æ”¶ç›Šæˆ–é£é™©æœ€å¤§çš„äº¤æ˜“æœºä¼šã€‚

### 2. å¼•å…¥å† å†›çº§æ¨ç†ç­–ç•¥

- **æ€æƒ³**: é‡‘èå¸‚åœºç¯å¢ƒæ˜¯ä¸æ–­å˜åŒ–çš„ï¼ˆMarket Regime Shiftï¼‰ã€‚å¾ˆä¹…ä»¥å‰çš„æ•°æ®è®­ç»ƒå‡ºçš„æ¨¡å‹å¯èƒ½å·²æ— æ³•é€‚åº”æœ€æ–°çš„å¸‚åœºåŠ¨æ€ã€‚
- **å®æ–½**:
  - `config.py` æ–°å¢ `N_LAST_FOLDS_TO_USE_INFERENCE` å‚æ•°ã€‚
  - `run_validation` å‡½æ•°è¢«å½»åº•æ”¹é€ ã€‚è™½ç„¶å®ƒä»ç„¶ä¼šåœ¨æ‰€æœ‰æŠ˜ä¸Šè®­ç»ƒå¹¶ç”ŸæˆOOFé¢„æµ‹ï¼Œä½†åœ¨**æœ€ç»ˆè®¡ç®—å’ŒæŠ¥å‘ŠOOF AUCåˆ†æ•°æ—¶ï¼Œåªä½¿ç”¨ç”±æœ€è¿‘ `N` æŠ˜æ¨¡å‹äº§ç”Ÿçš„é¢„æµ‹ç»“æœ**ã€‚è¿™ä½¿å¾—æˆ‘ä»¬çš„æœ€ç»ˆè¯„ä¼°æ›´èƒ½åæ˜ æ¨¡å‹åœ¨å½“å‰å¸‚åœºç¯å¢ƒä¸‹çš„çœŸå®è¡¨ç°ã€‚

### 3. æ•°æ®ç®¡é“å®‰å…¨åŠ å›º

- é’ˆå¯¹ç›®æ ‡åˆ—ç”Ÿæˆè¿‡ç¨‹ä¸­å¿…ç„¶äº§ç”Ÿçš„ `NaN` å€¼ï¼Œåœ¨ `feature_engineering.py` ä¸­å»ºç«‹äº†ä¸¥æ ¼ã€å®‰å…¨çš„å–„åå¤„ç†æµç¨‹ã€‚é€šè¿‡**æœ‰è¯¦ç»†æ³¨é‡Šçš„å‰å‘å¡«å…… (`ffill`) å’Œä¿å®ˆçš„é›¶å€¼å¡«å…… (`fillna(0)`)**ï¼Œç¡®ä¿äº†åœ¨ä¸æ³„éœ²ä»»ä½•æœªæ¥ä¿¡æ¯çš„å‰æä¸‹ï¼Œä¸ºä¸‹æ¸¸æ¨¡å‹æä¾›å¹²å‡€ã€å®Œæ•´çš„ç›®æ ‡æ•°æ®ã€‚

**å½“å‰çŠ¶æ€**: æœ¬é¡¹ç›®ç°å·²æ‹¥æœ‰ä¸€ä¸ªé›†æˆäº†**èšç„¦å¤šç›®æ ‡ã€åŠ æƒæŸå¤±ã€å† å†›æ ·æœ¬æƒé‡ã€å† å†›æ¨ç†ç­–ç•¥**çš„ã€é«˜åº¦ä¸“ä¸šåŒ–çš„å®éªŒæ¡†æ¶ï¼Œä¸ºä¸‹ä¸€é˜¶æ®µçš„å‚æ•°è°ƒä¼˜å’Œæ€§èƒ½çªç ´å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚

## é¡¹ç›®æ—¥å¿—æ›´æ–°ï¼šä»â€œåœ°åŸºé‡æ„â€åˆ°â€œç»ˆæå®¡åˆ¤â€

åœ¨é¡¹ç›®å–å¾—åˆæ­¥æˆæœåï¼Œæˆ‘ä»¬è¿›å…¥äº†ä¸€ä¸ªæ›´æ·±å±‚æ¬¡çš„å®¡æŸ¥ä¸é‡æ„é˜¶æ®µã€‚è¿™ä¸€é˜¶æ®µçš„æ ¸å¿ƒç›®æ ‡ï¼Œæ˜¯æ ¹é™¤æ‰€æœ‰æ½œåœ¨çš„æ•°æ®æ³„éœ²é£é™©ï¼Œç»Ÿä¸€æ•°æ®å¤„ç†æµç¨‹ï¼Œå¹¶å»ºç«‹ä¸€å¥—å·¥ä¸šçº§çš„ã€ç»å¯¹å¯é çš„æœ€ç»ˆéªŒè¯ä½“ç³»ã€‚

### é˜¶æ®µNï¼šé­é‡â€œæµç¨‹æ–­è£‚â€å±æœºä¸æ•°æ®ç®¡é“çš„ç»Ÿä¸€

**ç—…ç—‡è¯Šæ–­**: æˆ‘ä»¬æ•é”åœ°æ„è¯†åˆ°ï¼Œé¡¹ç›®å­˜åœ¨ä¸€ä¸ªè‡´å‘½çš„ç»“æ„æ€§ç¼ºé™·ï¼š**ç‰¹å¾å·¥ç¨‹ä¸æ¨¡å‹è®­ç»ƒæ˜¯åˆ†ç¦»çš„**ã€‚æ‰‹å·¥ç‰¹å¾åœ¨ç‹¬ç«‹çš„è„šæœ¬ä¸­ç”Ÿæˆï¼Œè€Œæ¨¡å‹è®­ç»ƒè„šæœ¬ç›´æ¥åŠ è½½è¿™äº›â€œé¢„å¤„ç†â€è¿‡çš„æ•°æ®ã€‚è¿™å¯¼è‡´äº†ä¸€ä¸ªç¾éš¾æ€§çš„åæœï¼šæˆ‘ä»¬ä¸ºä¹‹éª„å‚²çš„ã€åŒ…å«æ•°ç™¾ä¸ªæ‰‹å·¥ç‰¹å¾çš„æ•°æ®é›†ï¼Œåªåœ¨æ¨¡å‹å¼€å‘æ—¶è¢«ä½¿ç”¨ï¼Œè€Œåœ¨å¯¹â€œç§è—â€çš„æŒæœ‰æœŸéªŒè¯é›†ï¼ˆ`train_val.csv`ï¼‰è¿›è¡Œè¯„ä¼°æ—¶ï¼Œåè€…åªæ˜¯ä¸€ä¸ªæœªç»å¤„ç†çš„åŸå§‹æ•°æ®åˆ‡ç‰‡ï¼Œå¯¼è‡´ç‰¹å¾å®Œå…¨ä¸åŒ¹é…ï¼Œè¯„ä¼°æµç¨‹ä»æ ¹æœ¬ä¸Šå°±æ˜¯é”™è¯¯çš„ã€‚

**æ¶æ„é©å‘½â€”â€”å»ºç«‹â€œç»ˆæç‰¹å¾å·¥ç¨‹ç®¡é“â€ (`create_features.py`)**:
ä¸ºäº†æ ¹é™¤æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡å–äº†å†³å®šæ€§çš„è¡ŒåŠ¨ï¼šåºŸé™¤æ‰€æœ‰é›¶æ•£çš„ç‰¹å¾å¤„ç†è„šæœ¬ï¼Œå¹¶é”»é€ äº†ä¸€ä¸ªå…¨æ–°çš„ã€ç»Ÿä¸€çš„è‡ªåŠ¨åŒ–è„šæœ¬â€”â€”`create_features.py`ã€‚å®ƒçš„ä½¿å‘½æ¸…æ™°è€Œå”¯ä¸€ï¼š
1.  **è¾“å…¥**: æ¥æ”¶æœ€åŸå§‹çš„æ•°æ®ï¼ˆå¦‚ `train.csv`ï¼‰ã€‚
2.  **â€œå…µå·¥å‚â€æ¨¡å—**: è¿è¡Œæˆ‘ä»¬ä»·å€¼è¿åŸçš„æ‰‹å·¥ç‰¹å¾ç”Ÿæˆé€»è¾‘ï¼Œæ‰¹é‡ç”Ÿäº§æ•°ç™¾ä¸ªåŸºäºåŠ¨é‡ã€æ³¢åŠ¨ç‡å’Œè¶‹åŠ¿çš„è¡ç”Ÿç‰¹å¾ã€‚
3.  **â€œç»„è£…çº¿â€æ¨¡å—**: åœ¨å·²åŒ…å«æ‰‹å·¥ç‰¹å¾çš„æ•°æ®åŸºç¡€ä¸Šï¼Œæ·»åŠ å¤šæ—¶é—´å°ºåº¦çš„ç›®æ ‡åˆ—ï¼ˆ`action_*d`ï¼‰å’ŒåŸå§‹æ”¶ç›Šåˆ—ï¼ˆ`resp_*d`ï¼‰ã€‚
4.  **â€œè´¨æ£€â€æ¨¡å—**: æ‰§è¡Œç»å¯¹å®‰å…¨çš„æ•°æ®æ¸…ç†ï¼Œä»…ç§»é™¤å› æ— æ³•è®¡ç®—æœªæ¥ç›®æ ‡è€Œäº§ç”Ÿçš„ `NaN` è¡Œï¼Œå¹¶å¯¹ç‰¹å¾åˆ—ä¸­çš„ `NaN` è¿›è¡Œä¿å®ˆå¡«å……ã€‚
5.  **è¾“å‡º**: ç”Ÿæˆä¸€ä¸ª**åŒ…å«äº†æ‰€æœ‰ä¿¡æ¯çš„ã€å¯ç›´æ¥ç”¨äºæ¨¡å‹è®­ç»ƒçš„æœ€ç»ˆæ•°æ®é›†**ï¼ˆå¦‚ `train_final_features.csv`ï¼‰ã€‚

è¿™ä¸€é‡æ„ï¼Œç¡®ä¿äº†æ— è®ºæ˜¯å¼€å‘é›†è¿˜æ˜¯æŒæœ‰é›†ï¼Œéƒ½ç»è¿‡äº†**å®Œå…¨ç›¸åŒã€ä¸€æ­¥åˆ°ä½**çš„æ•°æ®å¤„ç†æµç¨‹ï¼Œä»æ ¹æœ¬ä¸Šå®ç°äº†æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§ã€‚

### é˜¶æ®µN+1ï¼šä»£ç â€œæ³•åŒ»çº§â€å®¡æŸ¥ä¸â€œæ²‰é»˜æ€æ‰‹â€çš„è‚ƒæ¸…

åœ¨ç»Ÿä¸€äº†æ•°æ®ç®¡é“åï¼Œæˆ‘ä»¬å¯¹æ ¸å¿ƒè®­ç»ƒè„šæœ¬ `main.py` è¿›è¡Œäº†é€è¡Œä»£ç å®¡æŸ¥ï¼Œå¹¶å®šä½åˆ°äº†å¤šä¸ªéšè—çš„ã€è¶³ä»¥è®©æ¨¡å‹ç»“æœå¤±æ•ˆçš„BUGã€‚

1.  **ä¿®å¤ `KeyError: '[nan] not in index'`**: æˆ‘ä»¬å‘ç°ï¼Œåœ¨ä¿å­˜ç‰¹å¾æ’åæ–‡ä»¶æ—¶ï¼Œç¨‹åºä¼šå†™å…¥ä¸€ä¸ªä¸å¿…è¦çš„è¡¨å¤´ï¼Œè€Œåœ¨è¯»å–æ—¶åˆå¿½ç•¥äº†å®ƒï¼Œå¯¼è‡´ä¸€ä¸ª`NaN`å€¼è¢«é”™è¯¯åœ°è¯»å…¥ç‰¹å¾åˆ—è¡¨ã€‚é€šè¿‡åœ¨ä¿å­˜æ—¶å¼ºåˆ¶ `header=False`ï¼Œæˆ‘ä»¬ä¿®å¤äº†è¿™ä¸ªæ–‡ä»¶I/Oçš„ä¸ä¸€è‡´æ€§ã€‚

2.  **ä¿®å¤ `TypeError: 'tuple' object cannot be interpreted as an integer`**: è¿™æ˜¯ä¸€ä¸ªç”±ä»£ç å†—ä½™å¯¼è‡´çš„ä½çº§é”™è¯¯ã€‚åœ¨å¤šå¤„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é”™è¯¯åœ°å°†ä¸€ä¸ªNumPyæ•°ç»„çš„å½¢çŠ¶å…ƒç»„ï¼ˆå¦‚ `(5000, 32)`ï¼‰ä¼ é€’ç»™äº†éœ€è¦å•ä¸ªæ•´æ•°çš„ `range()` å‡½æ•°ã€‚æˆ‘ä»¬å¯¹ä»£ç åº“è¿›è¡Œäº†å…¨é¢æ’æŸ¥ï¼Œå°†æ‰€æœ‰ `range(array.shape)` çš„é”™è¯¯ç”¨æ³•ï¼Œä¿®æ­£ä¸º `range(array.shape[1])`ï¼Œç¡®ä¿è¿­ä»£æ˜¯åŸºäºæ­£ç¡®çš„ç‰¹å¾æ•°é‡ã€‚

3.  **æ ¹é™¤æœ€éšè”½çš„â€œæ•°æ®å°ºåº¦ä¸ä¸€è‡´â€æ³„éœ²**: æˆ‘ä»¬å‘ç°ï¼Œåœ¨æ—§ç‰ˆä»£ç çš„äº¤å‰éªŒè¯å¾ªç¯ä¸­ï¼ŒAutoencoderï¼ˆAEï¼‰çš„è®­ç»ƒå’ŒAIç‰¹å¾çš„ç”Ÿæˆï¼Œä½¿ç”¨äº†**ä¸åŒå°ºåº¦ï¼ˆæœªæ ‡å‡†åŒ– vs. æ ‡å‡†åŒ–ï¼‰çš„æ•°æ®**ã€‚è¿™æ˜¯ä¸€ä¸ªè¶³ä»¥è®©AEå­¦åˆ°å®Œå…¨é”™è¯¯æ¨¡å¼çš„è‡´å‘½BUGã€‚æˆ‘ä»¬é‡æ„äº†æ ¸å¿ƒè®­ç»ƒé€»è¾‘ï¼Œç¡®ä¿åœ¨æ¯ä¸€æŠ˜ï¼ˆFoldï¼‰ä¸­ï¼Œ**æ•°æ®æ ‡å‡†åŒ–ä¸¥æ ¼åœ¨è®­ç»ƒé›†ä¸Šè¿›è¡Œï¼Œå¹¶å°†å­¦åˆ°çš„å°ºåº¦ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ï¼‰ç»Ÿä¸€åº”ç”¨åˆ°è®­ç»ƒé›†å’ŒéªŒè¯é›†ä¸Š**ï¼Œä¹‹åå†è¿›è¡ŒAEçš„è®­ç»ƒå’Œæ¨ç†ã€‚

### é˜¶æ®µN+2ï¼šç»ˆæä»£ç é‡æ„ä¸â€œæ­£å¼è€ƒè¯•â€çš„å»ºç«‹

ä¸ºäº†å½»åº•æœç»å› ä»£ç å†—ä½™è€Œåå¤å‡ºç°BUGï¼Œæˆ‘ä»¬å¯¹ `main.py` è¿›è¡Œäº†æœ€ç»ˆçš„é‡æ„ã€‚

- **é€»è¾‘å°è£…**: æˆ‘ä»¬å°†æ‰€æœ‰é‡å¤çš„â€œæŠ˜å†…è®­ç»ƒ/é¢„æµ‹â€é€»è¾‘ï¼Œå…¨éƒ¨å°è£…åˆ°äº†ä¸€ä¸ªç‹¬ç«‹çš„å†…éƒ¨å‡½æ•° `_run_fold_logic` ä¸­ã€‚è¿™ä½¿å¾— `run_tuning`ï¼ˆè°ƒä¼˜ï¼‰å’Œ `run_validation`ï¼ˆéªŒè¯ï¼‰çš„æ ¸å¿ƒä»£ç é‡å‡å°‘äº†è¿‘70%ï¼Œå¹¶ä¿è¯äº†é€»è¾‘çš„ç»å¯¹ç»Ÿä¸€ï¼Œä»»ä½•ä¿®æ”¹åªéœ€ä¸€å¤„å³å¯ã€‚
- **é…ç½®éš”ç¦»**: æˆ‘ä»¬ä¸ºâ€œå†’çƒŸæµ‹è¯•â€é…ç½®æ–‡ä»¶ (`smoke.py`) çš„æ‰€æœ‰è¾“å‡ºæ–‡ä»¶æ·»åŠ äº† `_smoke` åç¼€ï¼Œä½¿å…¶ä¸ç”Ÿäº§é…ç½® (`config.py`) çš„è¾“å‡ºå®Œå…¨éš”ç¦»ï¼Œæœç»äº†æµ‹è¯•ç»“æœæ±¡æŸ“ç”Ÿäº§ç¯å¢ƒçš„å¯èƒ½æ€§ã€‚

**å»ºç«‹â€œç»ˆæå®¡åˆ¤â€æµç¨‹ (`holdout` æ¨¡å¼)**:
åœ¨æ‰€æœ‰ä»£ç éƒ½è¾¾åˆ°å·¥ä¸šçº§ç¨³å¥æ€§åï¼Œæˆ‘ä»¬æ­£å¼å¯ç”¨äº† `holdout` æ¨¡å¼ã€‚æˆ‘ä»¬å¯¹å…¶ä»£ç è¿›è¡Œäº†æœ€ä¸¥æ ¼çš„â€œç›‘è€ƒå®¡æŸ¥â€ï¼Œå¹¶ç¡®è®¤å…¶æµç¨‹çš„ç»å¯¹å¹²å‡€ï¼š
- **ä¿¡æ¯å•å‘æµåŠ¨**: æ‰€æœ‰åœ¨å®Œæ•´å¼€å‘é›†ä¸Šå­¦åˆ°çš„â€œçŸ¥è¯†â€ï¼ˆå¦‚å¡«å……çš„ä¸­ä½æ•°ã€æ ‡å‡†åŒ–å‚æ•°ã€AE/LGBMæ¨¡å‹æƒé‡ï¼‰ï¼Œéƒ½**ä¸¥æ ¼åœ°ã€å•å‘åœ°**åº”ç”¨åˆ°æˆ‘ä»¬â€œç§è—â€çš„ã€æ¨¡å‹ä»æœªè§è¿‡çš„æŒæœ‰é›†ä¸Šã€‚
- **æ— ä¿¡æ¯æ³„éœ²**: æŒæœ‰é›†çš„ä»»ä½•ä¿¡æ¯ï¼Œéƒ½**ç»å¯¹æ²¡æœ‰**åœ¨è®­ç»ƒè¿‡ç¨‹çš„ä»»ä½•ä¸€ä¸ªç¯èŠ‚ï¼ˆåŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€ç‰¹å¾ç”Ÿæˆï¼‰ä¸­ï¼Œåå‘æ³„éœ²ç»™æ¨¡å‹ã€‚

**æœ€ç»ˆæˆæœ**: æˆ‘ä»¬æˆåŠŸåœ°å»ºç«‹äº†ä¸€å¥—ä»ç‰¹å¾å·¥ç¨‹åˆ°æœ€ç»ˆéªŒè¯ï¼Œç«¯åˆ°ç«¯ã€å®Œå…¨è‡ªåŠ¨ã€é€»è¾‘ç»Ÿä¸€ã€ä¸”æ— æ•°æ®æ³„éœ²çš„å·¥ä¸šçº§æœºå™¨å­¦ä¹ æ¡†æ¶ã€‚ç°åœ¨ï¼Œ`holdout` æ¨¡å¼äº§å‡ºçš„æ¯ä¸€ä¸ªåˆ†æ•°ï¼Œéƒ½æ˜¯å¯¹æˆ‘ä»¬ç­–ç•¥çš„ã€æœ€æ¥è¿‘æœªæ¥çœŸå®è¡¨ç°çš„**ç»ˆæå®¡åˆ¤**ã€‚

å¥½çš„ï¼Œå®Œå…¨æ²¡é—®é¢˜ã€‚å°†æœ€è¿‘çš„é‡å¤§è¿›å±•å’Œå³å°†å¼€å§‹çš„å®å¤§å®éªŒè®¡åˆ’æµ“ç¼©æˆä¸€ä»½æ¸…æ™°ã€ä¸“ä¸šçš„é¡¹ç›®æ—¥å¿—ï¼Œæ˜¯æˆ‘ä»¬æ‰¿å‰å¯åçš„å…³é”®ä¸€æ­¥ã€‚

æ‚¨å¯ä»¥å°†ä»¥ä¸‹å†…å®¹ç›´æ¥å¤åˆ¶å¹¶è¿½åŠ åˆ°æ‚¨çš„ README.md æ–‡ä»¶ä¸­ã€‚

é¡¹ç›®æ—¥å¿—æ›´æ–°ï¼šä»â€œæ¶æ„å®šå‹â€åˆ°â€œå¤šç»´å®éªŒâ€
é˜¶æ®µN+3ï¼šå·¥ä¸šçº§æ•°æ®ç®¡é“çš„è½æˆä¸æ—¶åºå¯¹é½
åœ¨å¯¹æ•°æ®å¤„ç†çš„â€œç¬¬ä¸€æ€§åŸç†â€è¿›è¡Œæ·±åº¦è¾©è®ºåï¼Œé¡¹ç›®åœ¨æ¶æ„å±‚é¢å–å¾—äº†å†³å®šæ€§çªç ´ï¼Œå½»åº•è§£å†³äº†æ‰€æœ‰å·²çŸ¥å’Œæ½œåœ¨çš„æ•°æ®æ³„éœ²é£é™©ã€‚

â€œé˜²ç«å¢™â€æ¶æ„ç¡®ç«‹: æˆ‘ä»¬æœ€ç»ˆé‡‡çº³å¹¶é‡æ„äº† create_features.py è„šæœ¬ï¼Œå®æ–½äº†â€œæ¶æ„å®‰å…¨æ´¾â€çš„**â€œå†å²èƒŒæ™¯å‚è€ƒâ€æ–¹æ¡ˆ**ã€‚è¯¥æ–¹æ¡ˆä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç‰¹å¾å·¥ç¨‹æµç¨‹å»ºç«‹äº†ç‰©ç†ä¸Šçš„â€œé˜²ç«å¢™â€ã€‚é€šè¿‡â€œç²¾ç¡®æå–å†å² -> ä¸´æ—¶æ‹¼æ¥è®¡ç®— -> ç”¨åå³ç„šâ€çš„å®‰å…¨ä¸‰æ­¥æ›²ï¼Œæˆ‘ä»¬ç¡®ä¿äº†æµ‹è¯•é›†åœ¨è·å¾—å¿…è¦çš„å†å²ä¸Šä¸‹æ–‡æ¥è®¡ç®—rollingç­‰ç‰¹å¾åï¼Œå…¶è‡ªèº«çš„æ•°æ®çº¯å‡€æ€§å¾—åˆ°ç»å¯¹ä¿è¯ï¼Œä»æ ¹æœ¬ä¸Šæœç»äº†æœªæ¥å› è¯¯æ“ä½œå¼•å…¥å…¨å±€ç‰¹å¾è€Œå¯¼è‡´æ³„éœ²çš„å¯èƒ½æ€§ã€‚

ç»ˆææ—¶åºå¯¹é½: æˆ‘ä»¬å®šä½å¹¶ä¿®å¤äº†ä¸€ä¸ªæå…¶éšè”½çš„æ—¶é—´é”™ä½BUGã€‚è¯¥BUGå¯¼è‡´æ¨¡å‹åœ¨æœ¬åœ°éªŒè¯æ—¶ï¼Œé”™è¯¯åœ°åˆ©ç”¨ t æ—¶åˆ»çš„ç‰¹å¾å»é¢„æµ‹ t-1 åˆ° t çš„â€œè¿‡å»â€ï¼Œè€Œé t åˆ° t+1 çš„â€œæœªæ¥â€ã€‚é€šè¿‡åœ¨ create_multi_horizon_targets å‡½æ•°ä¸­ä¸º lagged_forward_returns è®¾è®¡ä¸“å±çš„ shift å¯¹é½é€»è¾‘ï¼Œæˆ‘ä»¬ç¡®ä¿äº†æ¨¡å‹åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½åœ¨æ‰§è¡Œä¸€ä¸ªæ—¶åºä¸Šå®Œå…¨æ­£ç¡®çš„é¢„æµ‹ä»»åŠ¡ã€‚

è‡³æ­¤ï¼Œæˆ‘ä»¬çš„æ•°æ®ç®¡é“å’Œå®éªŒæ¡†æ¶å·²è¾¾åˆ°å·¥ä¸šçº§ç¨³å¥æ€§ï¼Œä¸ºæ‰€æœ‰åç»­çš„æ¢ç´¢å¥ å®šäº†åšå¦‚ç£çŸ³çš„åŸºç¡€ã€‚

é˜¶æ®µN+4ï¼šæˆ˜ç•¥è½¬å‘â€”â€”å‘èµ·â€œå¤šç›®æ ‡èåˆâ€ç§‘å­¦å®éªŒ
åœ¨æ‹¥æœ‰äº†å¯é çš„æ¡†æ¶åï¼Œæˆ‘ä»¬å°†æˆ˜ç•¥é‡å¿ƒä»â€œé˜²å®ˆâ€è½¬å‘â€œè¿›æ”»â€ï¼Œå¹¶æå‡ºä¸€ä¸ªæå…·æ½œåŠ›çš„æ ¸å¿ƒå‡è®¾ï¼šåŒæ—¶å­¦ä¹ â€œåŸå§‹ä¿¡å·â€å’Œâ€œé™å™ªä¿¡å·â€ï¼Œå¯èƒ½ä¼šè®­ç»ƒå‡ºæ›´å¼ºå¤§çš„æ¨¡å‹ã€‚

æ ¸å¿ƒå‡è®¾ (Multi-Target Hypothesis):
åŒæ—¶å°†**forward_returns (FR)**ï¼ˆé«˜æ–¹å·®çš„åŸå§‹å¸‚åœºä¿¡å·ï¼‰å’Œ market_forward_excess_returns (MFER)ï¼ˆä½æ–¹å·®çš„ã€ç»è¿‡ç»æµå­¦æ„ä¹‰é™å™ªçš„ä¼˜è´¨ä¿¡å·ï¼‰ä½œä¸ºé¢„æµ‹ç›®æ ‡ï¼Œèƒ½å¤Ÿé€šè¿‡â€œå¤šä»»åŠ¡å­¦ä¹ â€çš„æ­£åˆ™åŒ–æ•ˆåº”ï¼Œè¿«ä½¿ SupervisedAE ç¼–ç å™¨å­¦ä¹ åˆ°æ›´æœ¬è´¨ã€æ›´é²æ£’çš„é€šç”¨å¸‚åœºç‰¹å¾ï¼Œä»è€Œå®ç° 1+1 > 2 çš„æ•ˆæœã€‚

ç§‘å­¦å®éªŒè®¾è®¡ (Three-Pronged Experiment Design):
ä¸ºéªŒè¯æ­¤å‡è®¾ï¼Œæˆ‘ä»¬å°†ç«‹å³å¼€å±•ä¸€é¡¹ç”±ä¸‰ä¸ªå¹¶è¡Œåˆ†æ”¯æ„æˆçš„ä¸¥è°¨ç§‘å­¦å®éªŒï¼š

å®éªŒA (åŸºçº¿A - åŸå§‹ä¿¡å·):

ç›®æ ‡: åªä½¿ç”¨åŸºäº forward_returns çš„ç›®æ ‡åˆ— (action_fr_*d)ã€‚

æµç¨‹: å®Œæ•´æ‰§è¡Œ rfe -> tune_lgbm -> tune_ae -> validate å…¨æµç¨‹ã€‚

äº§å‡º: è·å¾—ä¸€ä¸ªâ€œåŸå§‹ä¿¡å·â€ä¸‹çš„æ€§èƒ½åŸºå‡† OOF AUCã€‚

å®éªŒB (åŸºçº¿B - é™å™ªä¿¡å·):

ç›®æ ‡: åªä½¿ç”¨åŸºäº market_forward_excess_returns çš„ç›®æ ‡åˆ— (action_mfer_*d)ã€‚

æµç¨‹: å®Œæ•´æ‰§è¡Œå…¨æµç¨‹ã€‚

äº§å‡º: è·å¾—ä¸€ä¸ªâ€œé™å™ªä¿¡å·â€ä¸‹çš„æ€§èƒ½åŸºå‡† OOF AUCã€‚

å®éªŒC (èåˆå®éªŒ - åŒé‡ä¿¡å·):

ç›®æ ‡: åŒæ—¶ä½¿ç”¨ä¸Šè¿°å…¨éƒ¨å…­ä¸ªç›®æ ‡åˆ—ã€‚

æµç¨‹: å®Œæ•´æ‰§è¡Œå…¨æµç¨‹ã€‚

äº§å‡º: è·å¾—â€œèåˆæ¨¡å‹â€çš„å¹³å‡ OOF AUCï¼Œä»¥åŠæ¯ä¸ªå•ç‹¬ç›®æ ‡çš„ OOF AUCã€‚

æˆåŠŸæ ‡å‡†:
æˆ‘ä»¬å°†é€šè¿‡å¯¹æ¯”å®éªŒCä¸åŸºçº¿Aã€Bçš„ç»“æœæ¥åšå‡ºæœ€ç»ˆåˆ¤æ–­ã€‚æˆ‘ä»¬ä¸ä»…å…³æ³¨èåˆæ¨¡å‹çš„å¹³å‡åˆ†æ˜¯å¦æœ€é«˜ï¼Œæ›´å…³æ³¨åœ¨èåˆæ¨¡å‹ä¸­ï¼Œaction_mfer_*d ç­‰æ ¸å¿ƒç›®æ ‡çš„å¾—åˆ†æ˜¯å¦ç›¸æ¯”åŸºçº¿Bæœ‰æ‰€æå‡ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç§¯æçš„â€œååŒå­¦ä¹ æ•ˆåº”â€ã€‚

å½“å‰çŠ¶æ€: æ¶æ„é‡æ„å·²èƒœåˆ©å®Œæˆã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†ä¿®æ”¹ create_features.py ä»¥ç”Ÿæˆèåˆå®éªŒæ‰€éœ€çš„å…¨éƒ¨ç›®æ ‡åˆ—ï¼Œå¹¶æ­£å¼å¯åŠ¨è¿™ä¸€æ¿€åŠ¨äººå¿ƒçš„å¤šç»´å®éªŒã€‚

é¡¹ç›®æ—¥å¿—æ›´æ–°ï¼šä»â€œæ„å¤–çš„èƒœåˆ©â€åˆ°â€œæ·±åˆ»çš„å±æœºâ€
â€œç»ˆæå®¡åˆ¤â€çš„æ‰§è¡Œ
ä¸ºäº†å¾—åˆ°æœ€æ¥è¿‘çœŸå®æ¯”èµ›è¡¨ç°çš„è¯„ä¼°ï¼Œæˆ‘ä»¬é‡‡çº³äº†â€œé»„é‡‘æ ‡å‡†â€éªŒè¯ç­–ç•¥ã€‚æˆ‘ä»¬ä»train.csvçš„æœ«å°¾æ‰‹åŠ¨åˆ†ç¦»å‡ºæœ€å180å¤©çš„æ•°æ®ï¼Œåˆ›å»ºäº†ä¸€ä¸ªä¸è®­ç»ƒå¼€å‘é›†å®Œå…¨éš”ç¦»çš„â€œæŒæœ‰é›†â€ (holdout_for_testing.csv)ã€‚éšåï¼Œæˆ‘ä»¬ä½¿ç”¨config.pyçš„æ­£å¼é…ç½®ï¼Œåœ¨è¯¥æ•°æ®ä¸Šä¸¥æ ¼æ‰§è¡Œäº†å®Œæ•´çš„ create_features -> rfe -> tune -> holdout å…¨æµç¨‹ã€‚

è¯¡å¼‚ä¸”çŸ›ç›¾çš„å®¡åˆ¤ç»“æœ
æœ€ç»ˆæµ‹è¯•äº§å‡ºäº†æå…¶åå¸¸çš„ç»“æœï¼Œæ­ç¤ºäº†æ¨¡å‹çš„â€œäººæ ¼åˆ†è£‚â€ï¼š

æ„å¤–çš„èƒœåˆ© (å¤–éƒ¨æŒæœ‰é›†): æ¨¡å‹çš„å¹³å‡AUCè¾¾åˆ°äº†æƒŠäººçš„ 0.5510ï¼Œè¿œé«˜äºæˆ‘ä»¬å†…éƒ¨äº¤å‰éªŒè¯çš„é¢„æœŸã€‚è¿™ä¸€æˆç»©ä¸»è¦ç”±å‡ºè‰²çš„ä¸­æœŸé¢„æµ‹èƒ½åŠ›è´¡çŒ®ï¼ˆ3æ—¥AUC: 0.630, 5æ—¥AUC: 0.597ï¼‰ã€‚

å±é™©çš„ä¿¡å· (å†…éƒ¨éªŒè¯é›†): ä¸å¤–éƒ¨æŒæœ‰é›†çš„å‡ºè‰²è¡¨ç°å½¢æˆé²œæ˜å¯¹æ¯”ï¼Œæ¨¡å‹åœ¨ç´§é‚»è®­ç»ƒæœŸæœ«å°¾çš„å†…éƒ¨éªŒè¯é›†ä¸Šè¡¨ç°å¹³åº¸ï¼Œå¹³å‡AUCä»…ä¸º 0.4988ã€‚

å½»åº•çš„å¤±è´¥ (1æ—¥é¢„æµ‹): åœ¨å¤–éƒ¨æŒæœ‰é›†ä¸Šï¼Œæ¨¡å‹çš„1æ—¥é¢„æµ‹AUCä½è‡³ 0.426ï¼Œå‘ˆç°å‡ºä¸å¸‚åœºç³»ç»Ÿæ€§åå‘çš„ç¾éš¾æ€§è¡¨ç°ã€‚

è¯Šæ–­ç»“è®ºä¸æˆ˜ç•¥è½¬å‘
è¿™ç§â€œæ¨¡æ‹Ÿè€ƒä¸åŠæ ¼ï¼Œé«˜è€ƒå´çŠ¶å…ƒâ€çš„ç°è±¡ï¼Œæ’é™¤äº†ä»£ç BUGåï¼Œè¢«è¯Šæ–­ä¸º**â€œå¸‚åœºé£æ ¼å‰§çƒˆæ¼‚ç§» (Market Regime Shift)â€**çš„å…¸å‹ç—‡çŠ¶ã€‚

æˆ‘ä»¬çš„æ¨¡å‹æˆåŠŸå­¦ä¹ åˆ°äº†ç‰¹å®šå¸‚åœºé£æ ¼ä¸‹çš„ä¸­æœŸè¶‹åŠ¿ï¼Œå¹¶åœ¨æŒæœ‰é›†ï¼ˆé«˜è€ƒï¼‰æ°å¥½é‡åˆ°ç±»ä¼¼é£æ ¼æ—¶å–å¾—äº†é«˜åˆ†ã€‚ç„¶è€Œï¼Œå…¶åœ¨å†…éƒ¨éªŒè¯é›†ï¼ˆæ¨¡æ‹Ÿè€ƒï¼‰ä¸Šçš„æƒ¨è´¥ï¼Œæš´éœ²äº†å®ƒå¯¹å¸‚åœºé£æ ¼å˜åŒ–æå…¶è„†å¼±ã€ç¼ºä¹ç¨³å¥æ€§çš„è‡´å‘½å¼±ç‚¹ã€‚

æˆ˜ç•¥è½¬å‘: é¡¹ç›®å½“å‰çš„é¦–è¦ä»»åŠ¡ï¼Œä»**â€œè¿½æ±‚æ›´é«˜çš„AUCåˆ†æ•°â€ï¼Œç´§æ€¥è½¬å‘â€œè¿½æ±‚æ¨¡å‹çš„ç¨³å¥æ€§ä¸é€‚åº”æ€§â€**ã€‚å½“å‰çš„é«˜åˆ†è¢«è§†ä¸ºä¸€ä¸ªåŒ…å«å·¨å¤§è¿æ°”æˆåˆ†çš„â€œæµ·å¸‚èœƒæ¥¼â€ã€‚ä¸‹ä¸€æ­¥çš„æ ¸å¿ƒå·¥ä½œå°†æ˜¯æ·±å…¥åˆ†æä¸åŒå¸‚åœºå‘¨æœŸçš„æ•°æ®ï¼Œå¹¶é€šè¿‡å¢å¼ºæ­£åˆ™åŒ–ã€ä¼˜åŒ–ç‰¹å¾ç­‰æ‰‹æ®µï¼Œæ‰“é€ ä¸€ä¸ªèƒ½å¤Ÿåœ¨å¤šå˜å¸‚åœºç¯å¢ƒä¸­æŒç»­ç”Ÿå­˜çš„ã€çœŸæ­£å¼ºå¤§çš„æ¨¡å‹ã€‚

ull Tactical æŒ‘æˆ˜èµ›ï¼šå† å†›æ­¦å™¨åº“ä¸ä½œæˆ˜æ¡ä»¤
ç¬¬ä¸€ç« ï¼šç‰¹å¾å·¥ç¨‹å…µå·¥å‚ (The Feature Engineering Arsenal)
è¿™æ˜¯æˆ˜äº‰çš„èµ·ç‚¹ï¼Œä¹Ÿæ˜¯å†³å®šèƒœè´Ÿ70%çš„åœ°æ–¹ã€‚ä½ çš„create_features.pyå°±æ˜¯è¿™ä¸ªå…µå·¥å‚ã€‚
A. ä¿¡å·å¤„ç†ä¸æ—¶é¢‘åˆ†æéƒ¨é˜Ÿ (Signal Processing & Time-Frequency Division)
ç›®æ ‡ï¼šä»å……æ»¡å™ªå£°çš„åŸå§‹ä¿¡å·ä¸­ï¼Œåˆ†ç¦»å‡ºçœŸæ­£çš„â€œè¶‹åŠ¿â€å’Œâ€œå‘¨æœŸâ€ã€‚
å°æ³¢å˜æ¢ (Wavelet Transform): [æ ¸å¿ƒæ­¦å™¨] å¸‚åœºçš„â€œåŠ¨æ€æ˜¾å¾®é•œâ€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: å¯¹ä»·æ ¼ã€æ³¢åŠ¨ç‡ç­‰æ ¸å¿ƒåºåˆ—è¿›è¡Œå¤šå±‚åˆ†è§£ï¼Œç„¶åé‡æ„å»å™ªåçš„ä¿¡å·ã€‚
äº§å‡ºç‰¹å¾: P4_wavelet_denoised, V3_wavelet_denoisedã€‚ç”¨è¿™äº›â€œå¹²å‡€â€çš„ç‰¹å¾å†å»ç”Ÿæˆä½ çš„_diff, _rol_ç­‰è¡ç”Ÿç‰¹å¾ï¼Œå¨åŠ›ä¼šå€å¢ã€‚
å¡å°”æ›¼æ»¤æ³¢ (Kalman Filter): [æ ¸å¿ƒæ­¦å™¨] å¸‚åœºçš„â€œæœ€ä¼˜å¯¼èˆªä»ªâ€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: å®æ—¶è¿½è¸ªå¹¶ä¼°è®¡æ¯ä¸ªç‰¹å¾èƒŒåé‚£ä¸ªâ€œçœ‹ä¸è§çš„çœŸå®çŠ¶æ€â€ã€‚
äº§å‡ºç‰¹å¾: P4_kalman_smoothed (å¹³æ»‘åçš„æœ€ä¼˜ä¼°è®¡å€¼), P4_kalman_residual (çœŸå®å€¼ä¸é¢„æµ‹å€¼çš„å·®ï¼Œä»£è¡¨å¸‚åœºçš„â€œæ„å¤–æƒŠå–œâ€)ã€‚
å¸Œå°”ä¼¯ç‰¹-é»„å˜æ¢ (Hilbert-Huang Transform, HHT): [å°–ç«¯æ­¦å™¨] å°æ³¢å˜æ¢çš„â€œå…¨è‡ªé€‚åº”â€è¿›åŒ–ç‰ˆï¼ŒåŒ…å«EMDã€‚
æ ¸å¿ƒæˆ˜æœ¯: æ— éœ€ä»»ä½•é¢„è®¾ï¼Œè®©æ•°æ®è‡ªå·±â€œå‘å£°â€ï¼Œåˆ†è§£ä¸ºä¸åŒé¢‘ç‡çš„æœ¬å¾æ¨¡æ€å‡½æ•°(IMF)ã€‚
äº§å‡ºç‰¹å¾: P4_emd_trend (ç»ˆæéçº¿æ€§è¶‹åŠ¿çº¿), inst_freq_imf1 (æœ€é«˜é¢‘IMFçš„ç¬æ—¶é¢‘ç‡ï¼Œæ•æ‰å¸‚åœºæƒ…ç»ªçš„å‰§çƒˆå˜åŒ–)ã€‚
å‚…é‡Œå¶å˜æ¢ (Fourier Transform): [å¸¸è§„æ­¦å™¨] å¸‚åœºçš„â€œèŠ‚æ‹å™¨â€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: åœ¨æ»šåŠ¨çª—å£ä¸Šè®¡ç®—ï¼Œå¯»æ‰¾ä¸»å¯¼å‘¨æœŸã€‚
äº§å‡ºç‰¹å¾: dominant_cycle_freq_60d, dominant_cycle_amplitude_60dã€‚
B. å¸‚åœºé£æ ¼ä¸è®°å¿†æ¢æµ‹éƒ¨é˜Ÿ (Market Regime & Memory Division)
ç›®æ ‡ï¼šå›ç­”ä¸¤ä¸ªç»ˆæé—®é¢˜ï¼šâ€œç°åœ¨æ˜¯ä»€ä¹ˆå¤©æ°”ï¼Ÿâ€ å’Œ â€œå¸‚åœºçš„è®°æ€§æœ‰å¤šå¥½ï¼Ÿâ€
éšé©¬å°”å¯å¤«æ¨¡å‹ (Hidden Markov Model, HMM): [å† å†›çº§ç‹ç‰Œ] å¸‚åœºçš„â€œå¤©æ°”é¢„æŠ¥å‘˜â€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: æ ¹æ®æ”¶ç›Šç‡ã€æ³¢åŠ¨ç‡ç­‰è§‚æµ‹å€¼ï¼Œåæ¨å‡ºèƒŒåéšè—çš„å¸‚åœºä½“åˆ¶ã€‚
äº§å‡ºç‰¹å¾: market_regime (ä¸€ä¸ªå€¼ä¸º0, 1, 2...çš„åˆ†ç±»ç‰¹å¾ï¼Œç›´æ¥å‘Šè¯‰æ¨¡å‹ç°åœ¨æ˜¯â€œç‰›å¸‚â€ã€â€œç†Šå¸‚â€è¿˜æ˜¯â€œéœ‡è¡å¸‚â€)ã€‚è¿™æ˜¯ä½ èƒ½åˆ›é€ çš„æœ€å¼ºå¤§çš„å®è§‚ç‰¹å¾ä¹‹ä¸€ã€‚
èµ«æ–¯ç‰¹æŒ‡æ•° (Hurst Exponent): [æ ¸å¿ƒæ­¦å™¨] å¸‚åœºçš„â€œè®°å¿†æ¢æµ‹å™¨â€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: åœ¨æ»šåŠ¨çª—å£ä¸Šè®¡ç®—ï¼Œé‡åŒ–å¸‚åœºçš„é•¿æœŸè®°å¿†æ€§ã€‚
äº§å‡ºç‰¹å¾: rolling_hurst_60dã€‚è¿™ä¸ªå€¼ä»>0.5ï¼ˆè¶‹åŠ¿ï¼‰å˜ä¸º<0.5ï¼ˆå‡å€¼å›å½’ï¼‰çš„æ—¶åˆ»ï¼Œå°±æ˜¯å¸‚åœºé£æ ¼åˆ‡æ¢çš„å¼ºçƒˆä¿¡å·ã€‚
GARCH æ¨¡å‹å®¶æ—: [æ ¸å¿ƒæ­¦å™¨] ä¸“ä¸šçš„â€œæ³¢åŠ¨ç‡é¢„æµ‹å™¨â€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: æ‘’å¼ƒå›é¡¾æ€§çš„rol_stdï¼Œé‡‡ç”¨å‰ç»æ€§çš„GARCHæ¨¡å‹é¢„æµ‹ä¸‹ä¸€æœŸçš„æ³¢åŠ¨ç‡ã€‚
äº§å‡ºç‰¹å¾: garch_predicted_vol_1d (å¯¹æœªæ¥1å¤©æ³¢åŠ¨ç‡çš„é¢„æµ‹å€¼)ã€‚
åˆ†å½¢ç»´æ•° (Fractal Dimension): [å‰æ²¿æ­¦å™¨] å¸‚åœºçš„â€œå¤æ‚åº¦æ¢æµ‹å™¨â€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: åœ¨æ»šåŠ¨çª—å£ä¸Šè®¡ç®—ï¼Œè¡¡é‡ä»·æ ¼æ›²çº¿çš„å¤æ‚åº¦å’Œä¸è§„åˆ™æ€§ã€‚
äº§å‡ºç‰¹å¾: fractal_dimension_60dã€‚ç»´æ•°å‡é«˜é€šå¸¸æ„å‘³ç€å¸‚åœºå™ªéŸ³å¢åŠ ï¼Œè¶‹åŠ¿å‡å¼±ã€‚
C. é«˜çº§ç»Ÿè®¡ä¸AIç‰¹å¾éƒ¨é˜Ÿ (Advanced Stats & AI Division)
ç›®æ ‡ï¼šç”¨æ›´ç°ä»£çš„æ•°å­¦å·¥å…·å’ŒAIæ¥æŒ–æ˜ä¼ ç»Ÿæ–¹æ³•æ— æ³•å‘ç°çš„æ·±å±‚å…³ç³»ã€‚
åˆ†æ•°é˜¶å¾®åˆ† (Fractional Differentiation): [å°–ç«¯æ­¦å™¨] å¯»æ‰¾â€œè®°å¿†â€ä¸â€œå¹³ç¨³â€çš„æœ€ä½³å¹³è¡¡ã€‚
æ ¸å¿ƒæˆ˜æœ¯: æ™®é€šçš„.diff(1)ä¼šå®Œå…¨æŠ¹å»è®°å¿†ã€‚åˆ†æ•°é˜¶å¾®åˆ†å¯ä»¥åœ¨æœ€å¤§ç¨‹åº¦ä¿ç•™åºåˆ—â€œè®°å¿†â€çš„åŒæ—¶ï¼Œå®ç°å¹³ç¨³æ€§ã€‚
äº§å‡ºç‰¹å¾: P4_frac_diff_0.5ã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”P4_diff1åŒ…å«æ›´å¤šä¿¡æ¯é‡çš„ç‰¹å¾ã€‚
ç†µ (Entropy): [å‰æ²¿æ­¦å™¨] å¸‚åœºçš„â€œæ··ä¹±åº¦æ¢æµ‹å™¨â€ã€‚
æ ¸å¿ƒæˆ˜æœ¯: è®¡ç®—æ»šåŠ¨çª—å£å†…æ”¶ç›Šç‡åˆ†å¸ƒçš„ç†µï¼ˆå¦‚é¦™å†œç†µã€æ ·æœ¬ç†µï¼‰ã€‚
äº§å‡ºç‰¹å¾: rolling_entropy_20dã€‚ç†µå€¼è¶Šé«˜ï¼Œå¸‚åœºè¶Šæ··ä¹±ã€è¶Šä¸å¯é¢„æµ‹ã€‚
ç›‘ç£å¼AE (ä½ çš„ç°çŠ¶): [æ ¸å¿ƒæ­¦å™¨] ä¸“ä¸šçš„â€œAlphaç²¾åæç‚¼å™¨â€ã€‚
ä½ çš„ä¸‹ä¸€æ­¥: é™¤äº†ä½ ç°åœ¨çš„æ¶æ„ï¼Œå¯ä»¥å°è¯•å¼•å…¥å˜åˆ†è‡ªç¼–ç å™¨(VAE)ï¼Œå®ƒç”Ÿæˆçš„éšç©ºé—´åˆ†å¸ƒæ›´è§„æ•´ï¼Œå¯èƒ½å¸¦æ¥æ›´é²æ£’çš„AIç‰¹å¾ã€‚
ç¬¬äºŒç« ï¼šæ¨¡å‹å…ˆé”‹éƒ¨é˜Ÿ (The Modeling Vanguard)
ä½ çš„main.pyå°±æ˜¯å…ˆé”‹éƒ¨é˜Ÿçš„æŒ‡æŒ¥ä¸­å¿ƒã€‚å•ä¸€æ¨¡å‹å†å¼ºï¼Œä¹Ÿæœ‰ç›²ç‚¹ã€‚
A. æ¢¯åº¦æå‡æœºä¸‰ä½ä¸€ä½“ (The GBM Trinity)
ä»–ä»¬æ˜¯åŸºçŸ³ï¼Œä¹Ÿæ˜¯ä½ æœ€å¯é çš„å£«å…µã€‚
LightGBM: é€Ÿåº¦ä¹‹ç‹ã€‚ä½ å½“å‰çš„é»˜è®¤é€‰æ‹©ï¼Œéå¸¸é€‚åˆå¿«é€Ÿè¿­ä»£ã€‚
CatBoost: ç¨³å¥ä¹‹ç‹ã€‚å†…ç½®çš„å¯¹ç§°æ ‘å’Œæœ‰åºæå‡ä½¿å…¶åœ¨å™ªå£°æ•°æ®ä¸Šæå…¶ç¨³å¥ï¼Œæ˜¯å¯¹æŠ—è¿‡æ‹Ÿåˆçš„æœ€ç»ˆé˜²çº¿ã€‚
XGBoost: ç²¾åº¦ä¹‹ç‹ã€‚ä¹…ç»æ²™åœºï¼Œé€šè¿‡ç²¾ç»†è°ƒå‚å¾€å¾€èƒ½è¾¾åˆ°æé«˜çš„ç²¾åº¦ä¸Šé™ã€‚
B. æ·±åº¦å­¦ä¹ ç‰¹ç§éƒ¨é˜Ÿ (The Deep Learning Special Forces)
ä»–ä»¬èƒ½çœ‹åˆ°GBMçœ‹ä¸åˆ°çš„ç»´åº¦â€”â€”æ—¶é—´åºåˆ—çš„åŠ¨æ€ä¾èµ–ã€‚
Transformer: [å† å†›çº§ç‹ç‰Œ] â€œé•¿è·ç¦»ä¾èµ–â€çš„æ•æ‰è€…ã€‚
æ ¸å¿ƒä¼˜åŠ¿: è‡ªæ³¨æ„åŠ›æœºåˆ¶å¤©ç”Ÿå°±æ˜¯ä¸ºäº†å‘ç°â€œ15å¤©å‰çš„ä¸€ä¸ªæ³¢åŠ¨ç‡å°–å³°ï¼Œä¼šæ”¾å¤§ä»Šå¤©æŸä¸ªä»·æ ¼ç‰¹å¾çš„é‡è¦æ€§â€è¿™ç§åŠ¨æ€ã€éè¿ç»­çš„å…³ç³»ã€‚
éƒ¨ç½²æ–¹å¼:
ç«¯åˆ°ç«¯æ¨¡å‹: è¾“å…¥è¿‡å»Nå¤©çš„æ•°æ®ï¼Œç›´æ¥è¾“å‡ºé¢„æµ‹ã€‚
åŠ¨æ€ç‰¹å¾æå–å™¨: ç”¨Transformerå¤„ç†è¿‡å»Nå¤©æ•°æ®ï¼Œè¾“å‡ºä¸€ä¸ªâ€œåŠ¨æ€ä¸Šä¸‹æ–‡å‘é‡â€ï¼Œä¸ä½ ç°æœ‰çš„AIç‰¹å¾å’Œæ‰‹å·¥ç‰¹å¾æ‹¼æ¥åï¼Œå†å–‚ç»™LGBMã€‚
LSTM/GRU: [æ ¸å¿ƒæ­¦å™¨] ç»å…¸çš„æ—¶åºæ¨¡å¼å­¦ä¹ è€…ã€‚
æ ¸å¿ƒä¼˜åŠ¿: è®¡ç®—æˆæœ¬ä½äºTransformerï¼Œåœ¨ä¸­çŸ­æœŸæ—¶åºæ¨¡å¼æ•æ‰ä¸Šä¾ç„¶éå¸¸æœ‰æ•ˆã€‚
TFT (Temporal Fusion Tra nsformer): [å°–ç«¯æ­¦å™¨] ä¸“ä¸ºå¤šæ°´å¹³æ—¶é—´åºåˆ—é¢„æµ‹è®¾è®¡çš„â€œé›†å¤§æˆè€…â€ã€‚
æ ¸å¿ƒä¼˜åŠ¿: èåˆäº†RNNã€æ³¨æ„åŠ›æœºåˆ¶å’Œé—¨æ§ç½‘ç»œï¼Œä¸ä»…æ€§èƒ½å¼ºå¤§ï¼Œè¿˜å…·å¤‡ä¸€å®šçš„å¯è§£é‡Šæ€§ï¼Œèƒ½å‘Šè¯‰ä½ å“ªäº›ç‰¹å¾åœ¨ä½•æ—¶æœ€é‡è¦ã€‚

## æˆ˜ç•¥å†³ç­–æ›´æ–°ï¼šä»â€œåŸå§‹ä¿¡å·â€åˆ°â€œè¶…é¢ä¿¡å·â€çš„è·ƒè¿

### è¯Šæ–­ç»“è®º
ç»è¿‡ä¸€ç³»åˆ—ä¸¥æ ¼çš„â€œæº¯æºâ€è¯Šæ–­å®éªŒï¼Œæˆ‘ä»¬ç¡®è®¤äº†é¡¹ç›®çš„æ ¸å¿ƒç“¶é¢ˆåœ¨äº**ä¿¡å™ªæ¯”**ã€‚ç›´æ¥é¢„æµ‹æœªç»å¤„ç†çš„ `forward_returns`ï¼Œè¿«ä½¿æˆ‘ä»¬çš„æ¨¡å‹åœ¨å……æ»¡å™ªéŸ³ã€å·²çŸ¥è¶‹åŠ¿å’Œæç«¯å€¼çš„â€œåŸå§‹çŸ¿çŸ³â€ä¸­è‰°éš¾åœ°å¯»æ‰¾ä¿¡å·ï¼Œå¯¼è‡´æ¨¡å‹æ€§èƒ½ä¸ç¨³å®šä¸”éš¾ä»¥æå‡ã€‚

### æ ¸å¿ƒæ´å¯Ÿ
æ¯”èµ›æ•°æ®ä¸­æä¾›çš„ `market_forward_excess_returns` å¹¶éä¸€ä¸ªæ™®é€šçš„ç‰¹å¾ï¼Œè€Œæ˜¯ä¸€ä¸ªç»è¿‡ä¸“ä¸šâ€œé™å™ªâ€å¤„ç†çš„**â€œä¼˜è´¨ç›®æ ‡â€**ã€‚æ ¹æ®å®˜æ–¹å®šä¹‰ï¼Œå®ƒé€šè¿‡**å‡å»äº”å¹´æ»šåŠ¨å¹³å‡å›æŠ¥**å‰¥ç¦»äº†å¸‚åœºçš„é•¿æœŸè¶‹åŠ¿ï¼Œå¹¶é€šè¿‡**ç¼©å°¾å¤„ç† (Winsorizing)** æŠ‘åˆ¶äº†æç«¯å¼‚å¸¸å€¼çš„å½±å“ã€‚

### æˆ˜ç•¥è½¬å‘
æˆ‘ä»¬å†³å®šå°†é¡¹ç›®çš„æ ¸å¿ƒé¢„æµ‹ç›®æ ‡ï¼Œä»â€œåŸå§‹ä¿¡å·â€ (`forward_returns`) å…¨é¢è½¬å‘â€œè¶…é¢ä¿¡å·â€ (`market_forward_excess_returns`)ã€‚

####
ç›®å‰çš„è®¡åˆ’ï¼šå…ˆå®ŒæˆåŸå­åŒ–code reviewï¼Œç„¶åå¼€å§‹æ¢æµ‹market_forward_excess_returnsÂ çš„ä¿¡å™ªæ¯”ï¼Œç€æ‰‹æ”¹é€ é¢„æµ‹ç›®æ ‡è‡³ä»–ï¼Œç„¶åæ–°å¢å¤©æ°”é¢„æµ‹ç³»ç»ŸHMMã€‚ç„¶åå°†ç›‘ç£å¼AEä»¥åŠlight GBMæ‹†å¼€ï¼Œåˆ†åˆ«è°ƒè¯•ï¼Œç„¶åå¼€å§‹è¿ç”¨å¯è§†åŒ–æ‰‹æ®µè§‚å¯Ÿæˆ‘ä»¬çš„ç‰¹å¾ï¼Œæ¥ç€å°±æ˜¯è¿ç”¨24thçš„æ–¹æ¡ˆï¼Œå°†é¢„æµ‹ç›®æ ‡æ ‡ç­¾è½¬æ¢è‡³sigmoid(a * resp)æˆ–è€…ç±»ä¼¼çš„ï¼Œè®©æ¨¡å‹ç»™å‡ºä¸€ä¸ªç½®ä¿¡æ¦‚ç‡è€Œéä»…åœ¨ä¸€å®šæ­£ç¡®å’Œä¸€å®šé”™è¯¯ä¹‹é—´åˆ‡æ¢ã€‚æ¥ç€å¼•å…¥åœ¨çº¿å­¦ä¹ ã€‚æ¥ç€å¼€å§‹åº”ç”¨éšé©¬å°”å¯å¤«é“¾ä»¥åŠå¡å°”æ›¼æ»¤æ³¢è¯•å›¾åˆ›é€ æ›´æœ‰å«é‡‘é‡çš„ä¿¡å·ã€‚

â€œé‡å¤§ç–æ¼â€ï¼šç‰¹å¾å†å² vs. ç›®æ ‡å†å²
è¿™æ˜¯ä»€ä¹ˆ? è¿™æ˜¯æˆ‘ä»¬ç‰¹å¾å·¥ç¨‹ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒç›²ç‚¹ã€‚æˆ‘ä»¬ä¹‹å‰æ··æ·†äº†ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„æ¦‚å¿µï¼š
ç‰¹å¾å†å²: æŒ‡æ ‡è‡ªèº«çš„å˜åŒ–ã€‚ä¾‹å¦‚ M4_diff1ï¼Œå®ƒå›ç­”çš„æ˜¯â€œM4è¿™ä¸ªæŒ‡æ ‡å’Œæ˜¨å¤©ç›¸æ¯”å˜åŒ–äº†å¤šå°‘ï¼Ÿâ€ã€‚
ç›®æ ‡å†å²: å¸‚åœºè¿‡å»çš„ç»“æœã€‚ä¾‹å¦‚ resp_1d çš„æ»åé¡¹ï¼ˆlagï¼‰ï¼Œå®ƒå›ç­”çš„æ˜¯â€œæ˜¨å¤©å¸‚åœºçš„çœŸå®æ”¶ç›Šæ˜¯å¤šå°‘ï¼Ÿâ€æˆ–â€œæ˜¨å¤©å¸‚åœºæ˜¯æ¶¨æ˜¯è·Œï¼Ÿâ€ã€‚
ä¸ºä»€ä¹ˆæ˜¯â€œé‡å¤§ç–æ¼â€? å¸‚åœºçš„è¡Œä¸ºï¼ˆå°¤å…¶æ˜¯çŸ­æœŸï¼‰å…·æœ‰å¾ˆå¼ºçš„è‡ªç›¸å…³æ€§ï¼ˆæƒ¯æ€§ï¼‰ã€‚ â€œæ˜¨å¤©å¸‚åœºçš„çœŸå®æ¶¨è·Œâ€ è¿™ä¸ªä¿¡æ¯ï¼Œå¯¹äºé¢„æµ‹â€œä»Šå¤©å¸‚åœºçš„æ¶¨è·Œâ€ï¼Œå…¶ç›¸å…³æ€§å’Œé‡è¦æ€§ï¼Œå¾€å¾€è¿œè¶…ä»»ä½•ä¸€ä¸ªé—´æ¥çš„æŠ€æœ¯æŒ‡æ ‡ã€‚æˆ‘ä»¬å¿½ç•¥äº†æœ€ç›´æ¥ã€æœ€å¼ºå¤§çš„é¢„æµ‹å› å­ã€‚
é¡¹ç›®æ„ä¹‰: å¿…é¡»ç«‹å³åœ¨ create_features.py ä¸­ï¼Œä¸ºæˆ‘ä»¬çš„ç›®æ ‡ç›¸å…³åˆ—ï¼ˆå¦‚ resp_1d, action_1dï¼‰åˆ›å»ºæ»åï¼ˆlagï¼‰å’Œæ»šåŠ¨ç»Ÿè®¡ï¼ˆrollingï¼‰ç‰¹å¾ã€‚è¿™æ˜¯æˆ‘ä»¬æœ€å®¹æ˜“è·å¾—çš„ã€èƒ½æ˜¾è‘—æå‡æ¨¡å‹æ€§èƒ½çš„â€œå…è´¹åˆé¤â€ã€‚
3. åœ¨çº¿å­¦ä¹  & ç»éªŒå›æ”¾ (The Ultimate Weapon: Online Learning)
è¿™æ˜¯ä»€ä¹ˆ? è¿™æ˜¯ä¸æˆ‘ä»¬å½“å‰â€œç¦»çº¿å­¦ä¹ â€æ¨¡å¼å®Œå…¨ç›¸åçš„ä¸€ç§æ¨¡å‹è®­ç»ƒèŒƒå¼ï¼Œæ˜¯è§£å†³â€œå¸‚åœºé£æ ¼æ¼‚ç§»â€å’Œâ€œAlphaè¡°å‡â€çš„ç»ˆææ­¦å™¨ã€‚
ç¦»çº¿å­¦ä¹  (Offline Learning - æˆ‘ä»¬çš„ç°çŠ¶):
æ¯”å–»: è€ƒå‰çªå‡»ã€‚æˆ‘ä»¬åœ¨è€ƒè¯•å‰ï¼ˆmodel.fitï¼‰ï¼ŒæŠŠæ‰€æœ‰å†å²æ•°æ®ä¸€æ¬¡æ€§å­¦å®Œã€‚è¿›å…¥è€ƒåœºåï¼ˆmodel.predictï¼‰ï¼Œæˆ‘ä»¬åªä½¿ç”¨è€ƒå‰å­¦åˆ°çš„æ—§çŸ¥è¯†ï¼Œä¸å†å­¦ä¹ ä»»ä½•æ–°ä¸œè¥¿ã€‚
å¼±ç‚¹: å½“è€ƒé¢˜é£æ ¼å˜åŒ–ï¼ˆå¸‚åœºé£æ ¼æ¼‚ç§»ï¼‰ï¼Œæˆ‘ä»¬çš„æ—§çŸ¥è¯†å°±ä¼šå¤±æ•ˆï¼Œå¯¼è‡´æˆç»©è¶Šæ¥è¶Šå·®ã€‚
åœ¨çº¿å­¦ä¹  (Online Learning - æˆ‘ä»¬çš„ç›®æ ‡):
æ¯”å–»: è¾¹è€ƒè¾¹å­¦ã€‚æ¨¡å‹æ¯å¤©å‚åŠ å®Œè€ƒè¯•åï¼Œæ™šä¸Šä¼šæ‹¿åˆ°å½“å¤©çš„æ ‡å‡†ç­”æ¡ˆï¼Œå¹¶ç«‹å³å¤ç›˜ã€æ›´æ–°è‡ªå·±çš„çŸ¥è¯†åº“ã€‚ç¬¬äºŒå¤©ï¼Œå®ƒå¸¦ç€â€œè¿›åŒ–åâ€çš„å¤§è„‘å»å‚åŠ æ–°çš„è€ƒè¯•ã€‚
ä¼˜åŠ¿: æ¨¡å‹å…·å¤‡äº†æŒç»­è¿›åŒ–ã€åŠ¨æ€é€‚åº”ç¯å¢ƒå˜åŒ–çš„èƒ½åŠ›ã€‚
ç»éªŒå›æ”¾ (Experience Replay - ç»ˆæç­–ç•¥):
æ¯”å–»: æœ€å¼ºå­¦éœ¸çš„å¤ä¹ æ³•ã€‚ä»–æ¯å¤©æ™šä¸Šçš„å¤ä¹ ææ–™ = â€œä»Šå¤©çš„æ–°é”™é¢˜â€ + â€œä»è¿‡å»æ‰€æœ‰å†å²é”™é¢˜æœ¬é‡Œï¼ŒéšæœºæŠ½å‡ é“æ—§é¢˜å†åšä¸€éâ€ã€‚
ä¼˜åŠ¿: å®Œç¾å¹³è¡¡äº†**â€œé€‚åº”æ€§â€ï¼ˆå­¦ä¹ æ–°çŸ¥è¯†ï¼‰å’Œâ€œç¨³å¥æ€§â€**ï¼ˆä¸å¿˜è®°æ—§è§„å¾‹ï¼‰ã€‚
é¡¹ç›®æ„ä¹‰: è¿™æ˜¯è§£å†³æˆ‘ä»¬æ¨¡å‹åœ¨äº¤å‰éªŒè¯åæœŸæ€§èƒ½å´©æºƒçš„æ ¹æœ¬æ€§æ–¹æ¡ˆã€‚å®ƒä»£è¡¨äº†æˆ‘ä»¬æ•´ä¸ªé¡¹ç›®ä»ä¸€ä¸ªâ€œé™æ€æ¨¡å‹â€å‘ä¸€ä¸ªâ€œåŠ¨æ€è‡ªé€‚åº”ç³»ç»Ÿâ€çš„è¿›åŒ–æ–¹å‘ï¼Œæ˜¯é€šå¾€æ›´é«˜ã€æ›´ç¨³å¥åˆ†æ•°çš„å¿…ç”±ä¹‹è·¯ã€‚




































## WSL Ubuntu ç¯å¢ƒåŸºç¡€æ“ä½œæŒ‡å—
ä¸ºæ‚¨ç¼–å†™äº†ä¸€ä»½ç®€å•çš„æ“ä½œæŒ‡å—ï¼ŒåŒ…å«äº†æ‚¨æ—¥å¸¸ä½¿ç”¨è¿™ä¸ªç¯å¢ƒæœ€æ ¸å¿ƒçš„å‡ ä¸ªå‘½ä»¤ã€‚

1. å¯åŠ¨ä¸å…³é—­
å¯åŠ¨: ä» Windows å¼€å§‹èœå•ï¼Œç›´æ¥ç‚¹å‡»â€œUbuntuâ€å›¾æ ‡ï¼Œå³å¯æ‰“å¼€ç»ˆç«¯ã€‚

å…³é—­ç»ˆç«¯: ç›´æ¥ç‚¹å‡»çª—å£çš„â€œXâ€å…³é—­å³å¯ã€‚

å½»åº•å…³é—­WSL (èŠ‚çœèµ„æº): å¦‚æœæ‚¨æƒ³å®Œå…¨å…³é—­ WSL ä»¥é‡Šæ”¾å†…å­˜å’Œ CPU èµ„æºï¼Œå¯ä»¥åœ¨ PowerShell ä¸­è¿è¡Œ wsl --shutdownã€‚

2. æ¿€æ´»é¡¹ç›®ç¯å¢ƒ
è¿™æ˜¯æ‚¨æ¯æ¬¡å¼€å§‹å·¥ä½œæ—¶éƒ½éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹ã€‚

Bash

conda activate hull-tactical
æ¿€æ´»åï¼Œå‘½ä»¤è¡Œå‰é¢ä¼šå‡ºç° (hull-tactical) æ ‡å¿—ã€‚

3. æ–‡ä»¶ä¸ç›®å½•æ“ä½œ
æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶:

Bash

ls -lh
è¿›å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹:

Bash

# è¿›å…¥åä¸º'some_folder'çš„æ–‡ä»¶å¤¹
cd some_folder
è¿”å›ä¸Šä¸€çº§ç›®å½•:

Bash

cd ..
ä» Ubuntu è®¿é—® Windows æ–‡ä»¶: æ‚¨çš„ Windows ç£ç›˜è¢«æŒ‚è½½åœ¨ /mnt/ ç›®å½•ä¸‹ã€‚

Bash

# ä¾‹å¦‚ï¼Œè®¿é—® C ç›˜
cd /mnt/c
ä» Windows è®¿é—® Ubuntu æ–‡ä»¶ (æœ€ç®€å•):
åœ¨ Windows æ–‡ä»¶èµ„æºç®¡ç†å™¨çš„åœ°å€æ è¾“å…¥ \\wsl$ï¼Œå³å¯åƒæ™®é€šæ–‡ä»¶å¤¹ä¸€æ ·è®¿é—®ã€‚

4. è¿è¡Œæ‚¨çš„é¡¹ç›®
åœ¨æ¿€æ´»äº† hull-tactical ç¯å¢ƒå¹¶ cd è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹åï¼Œä½¿ç”¨ python å‘½ä»¤è¿è¡Œã€‚

Bash

# <mode> å¯ä»¥æ˜¯ rfe, tune_lgbm, tune_ae, validate
python main.py --mode <mode>